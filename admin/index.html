<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveGigs Asia - åå°ç®¡ç† (è‡ªåŠ¨åŒæ­¥)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
            background: #050505;
            color: #c0c0c0;
            min-height: 100vh;
        }
        .header {
            background: rgba(0,0,0,0.9);
            border-bottom: 3px solid #8b0000;
            padding: 20px;
            position: fixed;
            top: 0; left: 0; right: 0;
            z-index: 1000;
        }
        .header h1 {
            color: #8b0000;
            font-size: 32px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .header p {
            color: #c0c0c0;
            font-size: 14px;
            margin-top: 5px;
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 120px 20px 40px;
        }
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        .nav-tab {
            padding: 12px 24px;
            background: #1a1a1a;
            border: 2px solid #333;
            color: #c0c0c0;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 14px;
            transition: all 0.3s;
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
        }
        .nav-tab:hover, .nav-tab.active {
            background: #8b0000;
            border-color: #8b0000;
            color: #fff;
        }
        .section { display: none; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .section-title {
            font-size: 28px;
            color: #8b0000;
            margin-bottom: 20px;
            text-transform: uppercase;
            border-left: 5px solid #8b0000;
            padding-left: 15px;
        }
        .card {
            background: #0a0a0a;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #c0c0c0;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            background: #1a1a1a;
            border: 2px solid #333;
            color: #fff;
            font-size: 14px;
            font-family: Arial, sans-serif;
            border-radius: 4px;
        }
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #8b0000;
        }
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
        }
        .btn {
            padding: 12px 30px;
            background: #8b0000;
            color: #fff;
            border: none;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 14px;
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
            border-radius: 4px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .btn:hover { background: #a00000; }
        .btn-secondary { background: #333; }
        .btn-secondary:hover { background: #444; }
        .btn-success { background: #006400; }
        .btn-success:hover { background: #008000; }
        .btn-warning { background: #cc6600; }
        .btn-warning:hover { background: #e67300; }
        .item-list { margin-top: 20px; }
        .item-card {
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .item-card:hover { border-color: #8b0000; }
        .item-info h4 {
            color: #fff;
            font-size: 18px;
            margin-bottom: 5px;
        }
        .item-info p {
            color: #888;
            font-size: 13px;
            font-family: Arial, sans-serif;
        }
        .item-actions { display: flex; gap: 10px; }
        .btn-small {
            padding: 8px 16px;
            font-size: 12px;
            border: none;
            cursor: pointer;
            text-transform: uppercase;
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
            border-radius: 4px;
        }
        .btn-edit { background: #c0c0c0; color: #000; }
        .btn-delete { background: #8b0000; color: #fff; }
        .carousel-item {
            background: #1a1a1a;
            border: 2px solid #444;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .carousel-item h4 {
            color: #8b0000;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-family: Arial, sans-serif;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            text-transform: uppercase;
            margin-left: 10px;
        }
        .status-active {
            background: rgba(0,100,0,0.3);
            color: #00ff00;
            border: 1px solid #006400;
        }
        .status-inactive {
            background: rgba(139,0,0,0.3);
            color: #ff6666;
            border: 1px solid #8b0000;
        }
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-family: Arial, sans-serif;
        }
        .alert-success {
            background: rgba(0,100,0,0.2);
            border: 2px solid #006400;
            color: #00ff00;
        }
        .alert-error {
            background: rgba(139,0,0,0.2);
            border: 2px solid #8b0000;
            color: #ff6666;
        }
        .alert-info {
            background: rgba(0,100,100,0.2);
            border: 2px solid #008080;
            color: #00ffff;
        }
        .sync-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #1a1a1a;
            border: 2px solid #333;
            padding: 15px 20px;
            border-radius: 8px;
            display: none;
            z-index: 9999;
        }
        .sync-status.show { display: block; }
        .sync-status.syncing { border-color: #cc6600; }
        .sync-status.success { border-color: #006400; }
        .sync-status.error { border-color: #8b0000; }
        .token-input {
            background: #0a0a0a !important;
            border-color: #8b0000 !important;
            color: #00ff00 !important;
            font-family: monospace !important;
        }
        .progress-bar {
            width: 100%;
            height: 4px;
            background: #333;
            margin-top: 10px;
            display: none;
        }
        .progress-bar.show { display: block; }
        .progress-fill {
            height: 100%;
            background: #8b0000;
            width: 0%;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>LiveGigs Asia - åå°ç®¡ç†</h1>
        <p>è‡ªåŠ¨åŒæ­¥åˆ° GitHub | ä¿å­˜åç«‹å³æ›´æ–°ç½‘ç«™</p>
    </div>

    <div class="container">
        <div id="alertContainer"></div>

        <!-- GitHub Token é…ç½® -->
        <div class="card" style="border-color: #8b0000;">
            <h3 style="color: #8b0000; margin-bottom: 15px;">ğŸ” GitHub é…ç½®</h3>
            <div class="form-group">
                <label>GitHub Personal Access Token</label>
                <input type="password" id="githubToken" class="token-input" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx">
                <p class="help-text">Token åªä¿å­˜åœ¨å½“å‰é¡µé¢ï¼Œåˆ·æ–°åéœ€é‡æ–°è¾“å…¥ã€‚ç”¨äºè‡ªåŠ¨æäº¤åˆ° GitHub ä»“åº“ã€‚</p>
            </div>
            <div class="grid-2">
                <div class="form-group">
                    <label>ä»“åº“æ‰€æœ‰è€…</label>
                    <input type="text" id="repoOwner" value="EmanonEnt" placeholder="ä¾‹å¦‚: EmanonEnt">
                </div>
                <div class="form-group">
                    <label>ä»“åº“åç§°</label>
                    <input type="text" id="repoName" value="asia" placeholder="ä¾‹å¦‚: asia">
                </div>
            </div>
            <div class="form-group">
                <label>åˆ†æ”¯</label>
                <input type="text" id="repoBranch" value="main" placeholder="main">
            </div>
            <button class="btn btn-success" onclick="testConnection()">æµ‹è¯•è¿æ¥</button>
            <button class="btn btn-secondary" onclick="saveTokenTemp()">ä¸´æ—¶ä¿å­˜Tokenï¼ˆ1å°æ—¶ï¼‰</button>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('banners')">Bannerç®¡ç†</button>
            <button class="nav-tab" onclick="showSection('posters')">æµ·æŠ¥åŒºåŸŸ</button>
            <button class="nav-tab" onclick="showSection('events')">æ´»åŠ¨ç®¡ç†</button>
            <button class="nav-tab" onclick="showSection('partners')">åˆä½œä¼™ä¼´</button>
            <button class="nav-tab" onclick="showSection('footer')">åº•éƒ¨ç®¡ç†</button>
            <button class="nav-tab" onclick="showSection('sync')">åŒæ­¥çŠ¶æ€</button>
        </div>

        <!-- Bannerç®¡ç† -->
        <div id="banners" class="section active">
            <h2 class="section-title">Banner ç®¡ç† (index + cn å…±ç”¨)</h2>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">æ·»åŠ /ç¼–è¾‘ Banner</h3>
                <form id="bannerForm">
                    <input type="hidden" id="bannerEditIndex" value="">
                    <div class="grid-2">
                        <div class="form-group">
                            <label>æ ‡é¢˜ *</label>
                            <input type="text" id="bannerTitle" placeholder="THE NONAME FESTIVAL">
                        </div>
                        <div class="form-group">
                            <label>æ’åº</label>
                            <input type="number" id="bannerOrder" value="1" min="1">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>å›¾ç‰‡åœ°å€ *</label>
                        <input type="text" id="bannerImage" placeholder="./image/banner.jpg æˆ– https://...">
                        <p class="help-text">æ”¯æŒ: æœ¬åœ°è·¯å¾„ ./image/xxx.jpg æˆ– ç½‘ç»œåœ°å€ https://...</p>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>æŒ‰é’®æ–‡å­—</label>
                            <input type="text" id="bannerButton" placeholder="View Details â†’">
                        </div>
                        <div class="form-group">
                            <label>é“¾æ¥åœ°å€</label>
                            <input type="text" id="bannerLink" placeholder="./events.html æˆ– https://...">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="bannerActive" checked> å¯ç”¨
                        </label>
                    </div>

                    <div>
                        <button type="button" class="btn btn-success" onclick="saveBanner()">ğŸ’¾ ä¿å­˜å¹¶åŒæ­¥</button>
                        <button type="button" class="btn btn-secondary" onclick="resetBannerForm()">é‡ç½®</button>
                    </div>
                </form>
            </div>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">ç°æœ‰ Banner åˆ—è¡¨</h3>
                <div id="bannerList"></div>
            </div>
        </div>

        <!-- æµ·æŠ¥ç®¡ç† -->
        <div id="posters" class="section">
            <h2 class="section-title">æµ·æŠ¥åŒºåŸŸç®¡ç†</h2>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">é€‰æ‹©é¡µé¢</h3>
                <div class="form-group">
                    <select id="posterPage" onchange="switchPosterPage()">
                        <option value="index">é¦–é¡µ (index)</option>
                        <option value="cn">å›½å†…ç«™ (cn)</option>
                        <option value="events">æ´»åŠ¨é¡µ (events) - æµ·æŠ¥2æ”¯æŒæ»šæ’­</option>
                    </select>
                </div>
            </div>

            <div id="posterForms"></div>

            <div class="card">
                <button class="btn btn-success" onclick="savePosters()">ğŸ’¾ ä¿å­˜æµ·æŠ¥å¹¶åŒæ­¥</button>
            </div>
        </div>

        <!-- æ´»åŠ¨ç®¡ç† -->
        <div id="events" class="section">
            <h2 class="section-title">Events æ´»åŠ¨ç®¡ç†</h2>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">æ·»åŠ /ç¼–è¾‘æ´»åŠ¨</h3>
                <form id="eventForm">
                    <input type="hidden" id="eventEditIndex" value="">

                    <div class="grid-2">
                        <div class="form-group">
                            <label>æ´»åŠ¨æ ‡é¢˜ *</label>
                            <input type="text" id="eventTitle" placeholder="æ´»åŠ¨åç§°">
                        </div>
                        <div class="form-group">
                            <label>æ—¥æœŸ (ç”¨äºå€’è®¡æ—¶) *</label>
                            <input type="date" id="eventDate">
                        </div>
                    </div>

                    <div class="grid-3">
                        <div class="form-group">
                            <label>åœ°ç‚¹</label>
                            <input type="text" id="eventLocation" placeholder="Shanghai">
                        </div>
                        <div class="form-group">
                            <label>æ—¶é—´</label>
                            <input type="text" id="eventTime" placeholder="19:00">
                        </div>
                        <div class="form-group">
                            <label>é—¨ç¥¨</label>
                            <input type="text" id="eventTicket" placeholder="$50">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>æµ·æŠ¥å›¾ç‰‡ *</label>
                        <input type="text" id="eventImage" placeholder="./image/event.jpg æˆ– https://...">
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>çŠ¶æ€</label>
                            <select id="eventStatus">
                                <option value="">æ­£å¸¸ (æ˜¾ç¤ºå€’è®¡æ—¶)</option>
                                <option value="ontour">ON TOUR</option>
                                <option value="soldout">SOLD OUT</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>è¯¦æƒ…</label>
                            <input type="text" id="eventDesc" placeholder="æ´»åŠ¨æè¿°...">
                        </div>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>æŒ‰é’®æ–‡å­—</label>
                            <input type="text" id="eventButton" value="Get Tickets â†’">
                        </div>
                        <div class="form-group">
                            <label>é“¾æ¥åœ°å€</label>
                            <input type="text" id="eventLink" placeholder="./tickets.html æˆ– https://...">
                        </div>
                    </div>

                    <div>
                        <button type="button" class="btn btn-success" onclick="saveEvent()">ğŸ’¾ ä¿å­˜æ´»åŠ¨å¹¶åŒæ­¥</button>
                        <button type="button" class="btn btn-secondary" onclick="resetEventForm()">é‡ç½®</button>
                    </div>
                </form>
            </div>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">æ´»åŠ¨åˆ—è¡¨</h3>
                <div id="eventList"></div>
            </div>
        </div>

        <!-- åˆä½œä¼™ä¼´ -->
        <div id="partners" class="section">
            <h2 class="section-title">åˆä½œä¼™ä¼´ç®¡ç†</h2>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">4ä¸ª Banner è®¾ç½®</h3>
                <div id="partnerBanners"></div>
            </div>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">Collaborators Logo</h3>
                <div class="form-group">
                    <label>æ·»åŠ  Logo (å›¾ç‰‡åœ°å€)</label>
                    <input type="text" id="collabLogo" placeholder="./image/partner-logo.png æˆ– https://...">
                </div>
                <button class="btn" onclick="addCollaborator()">æ·»åŠ  Logo</button>

                <div style="margin-top: 20px;">
                    <p style="color: #888; margin-bottom: 10px;">ç°æœ‰ Logo (<span id="collabCount">0</span>ä¸ª):</p>
                    <div id="collabList" style="display: flex; flex-wrap: wrap; gap: 15px;"></div>
                </div>
            </div>

            <div class="card">
                <button class="btn btn-success" onclick="savePartners()">ğŸ’¾ ä¿å­˜åˆä½œä¼™ä¼´å¹¶åŒæ­¥</button>
            </div>
        </div>

        <!-- åº•éƒ¨ç®¡ç† -->
        <div id="footer" class="section">
            <h2 class="section-title">åº•éƒ¨åŒºåŸŸç®¡ç†</h2>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">é€‰æ‹©ç«™ç‚¹</h3>
                <div class="form-group">
                    <select id="footerSite" onchange="loadFooter()">
                        <option value="global">æµ·å¤–ç«™ (Global)</option>
                        <option value="cn">å›½å†…ç«™ (CN)</option>
                    </select>
                </div>
            </div>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">ç¼–è¾‘åº•éƒ¨å†…å®¹</h3>
                <form id="footerForm">
                    <div class="form-group">
                        <label>ç‰ˆæƒæ–‡å­—</label>
                        <input type="text" id="footerCopyright" value="Â© 2026 LIVEGIGS ASIA. ALL RIGHTS RESERVED.">
                    </div>

                    <div class="form-group">
                        <label>ç¤¾äº¤é“¾æ¥ (JSONæ ¼å¼)</label>
                        <textarea id="footerSocial" rows="10"></textarea>
                        <p class="help-text">æ ¼å¼: [{"name": "æ˜¾ç¤ºå", "url": "é“¾æ¥", "icon": "å›¾æ ‡å"}]</p>
                    </div>

                    <div class="form-group">
                        <label>åˆ¶ä½œå•ä½ Logo</label>
                        <input type="text" id="footerProducer" value="./image/emanonent-logo.png">
                    </div>

                    <button type="button" class="btn btn-success" onclick="saveFooter()">ğŸ’¾ ä¿å­˜åº•éƒ¨å¹¶åŒæ­¥</button>
                </form>
            </div>
        </div>

        <!-- åŒæ­¥çŠ¶æ€ -->
        <div id="sync" class="section">
            <h2 class="section-title">åŒæ­¥çŠ¶æ€</h2>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">æ–‡ä»¶åŒæ­¥çŠ¶æ€</h3>
                <div id="syncStatusList">
                    <p style="color: #666;">ç‚¹å‡»"ä¿å­˜å¹¶åŒæ­¥"åæŸ¥çœ‹çŠ¶æ€</p>
                </div>
            </div>

            <div class="card">
                <h3 style="color: #8b0000; margin-bottom: 20px;">æ‰‹åŠ¨åŒæ­¥æ‰€æœ‰æ–‡ä»¶</h3>
                <button class="btn btn-success" onclick="syncAllFiles()">ğŸ”„ åŒæ­¥æ‰€æœ‰æ–‡ä»¶åˆ° GitHub</button>
                <div class="progress-bar" id="syncProgress">
                    <div class="progress-fill" id="syncProgressFill"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŒæ­¥çŠ¶æ€æµ®çª— -->
    <div class="sync-status" id="syncFloat">
        <span id="syncMessage">åŒæ­¥ä¸­...</span>
    </div>

    <script>
        // ========== é…ç½® ==========
        const CONFIG = {
            files: {
                banners: 'content/banners.json',
                indexPosters: 'content/index-posters.json',
                cnPosters: 'content/cn-posters.json',
                eventsPosters: 'content/events-posters.json',
                eventsManaged: 'content/events-managed.json',
                partnersBanners: 'content/partners-banners.json',
                collaborators: 'content/collaborators.json',
                footer: 'content/footer.json'
            }
        };

        // ========== æ•°æ®å­˜å‚¨ ==========
        let appData = {
            banners: [],
            posters: { index: [{},{},{}], cn: [{},{},{}], events: [{},{},{}] },
            events: [],
            partners: [{},{},{},{}],
            collaborators: [],
            footer: { global: {}, cn: {} }
        };

        // ========== GitHub API å‡½æ•° ==========
        function getGitHubConfig() {
            return {
                token: document.getElementById('githubToken').value.trim(),
                owner: document.getElementById('repoOwner').value.trim() || 'EmanonEnt',
                repo: document.getElementById('repoName').value.trim() || 'asia',
                branch: document.getElementById('repoBranch').value.trim() || 'main'
            };
        }

        function showSync(message, type = 'syncing') {
            const float = document.getElementById('syncFloat');
            const msg = document.getElementById('syncMessage');
            msg.textContent = message;
            float.className = 'sync-status show ' + type;
            if (type !== 'syncing') {
                setTimeout(() => float.classList.remove('show'), 3000);
            }
        }

        function hideSync() {
            document.getElementById('syncFloat').classList.remove('show');
        }

        // è·å–æ–‡ä»¶SHAï¼ˆç”¨äºæ›´æ–°ï¼‰
        async function getFileSHA(config, path) {
            try {
                const response = await fetch(`https://api.github.com/repos/${config.owner}/${config.repo}/contents/${path}?ref=${config.branch}`, {
                    headers: {
                        'Authorization': `token ${config.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (response.status === 404) return null;
                if (!response.ok) throw new Error('è·å–æ–‡ä»¶ä¿¡æ¯å¤±è´¥');

                const data = await response.json();
                return data.sha;
            } catch (e) {
                console.log('è·å–SHAå¤±è´¥:', e);
                return null;
            }
        }

        // æäº¤æ–‡ä»¶åˆ°GitHub
        async function commitToGitHub(path, content, message) {
            const config = getGitHubConfig();

            if (!config.token) {
                throw new Error('è¯·å…ˆè¾“å…¥ GitHub Token');
            }

            showSync(`æ­£åœ¨åŒæ­¥ ${path}...`);

            const sha = await getFileSHA(config, path);
            const body = {
                message: message || `Update ${path} via admin`,
                content: btoa(unescape(encodeURIComponent(JSON.stringify(content, null, 2)))),
                branch: config.branch
            };

            if (sha) body.sha = sha;

            const response = await fetch(`https://api.github.com/repos/${config.owner}/${config.repo}/contents/${path}`, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${config.token}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(body)
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || 'åŒæ­¥å¤±è´¥');
            }

            showSync(`${path} åŒæ­¥æˆåŠŸ!`, 'success');
            return true;
        }

        // æµ‹è¯•è¿æ¥
        async function testConnection() {
            const config = getGitHubConfig();
            if (!config.token) {
                showAlert('è¯·å…ˆè¾“å…¥ Token', 'error');
                return;
            }

            showSync('æµ‹è¯•è¿æ¥ä¸­...');

            try {
                const response = await fetch(`https://api.github.com/repos/${config.owner}/${config.repo}`, {
                    headers: {
                        'Authorization': `token ${config.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (!response.ok) throw new Error('è¿æ¥å¤±è´¥');

                const data = await response.json();
                showAlert(`âœ… è¿æ¥æˆåŠŸ! ä»“åº“: ${data.full_name}`, 'success');
                showSync('è¿æ¥æˆåŠŸ', 'success');
            } catch (e) {
                showAlert('âŒ è¿æ¥å¤±è´¥: ' + e.message, 'error');
                showSync('è¿æ¥å¤±è´¥', 'error');
            }
        }

        // ä¸´æ—¶ä¿å­˜Tokenï¼ˆsessionStorageï¼Œå…³é—­é¡µé¢å¤±æ•ˆï¼‰
        function saveTokenTemp() {
            const token = document.getElementById('githubToken').value;
            if (token) {
                sessionStorage.setItem('gh_token', token);
                showAlert('Token å·²ä¸´æ—¶ä¿å­˜ï¼ˆå…³é—­é¡µé¢åå¤±æ•ˆï¼‰', 'success');
            }
        }

        // åŠ è½½ä¸´æ—¶ä¿å­˜çš„Token
        function loadTempToken() {
            const token = sessionStorage.getItem('gh_token');
            if (token) {
                document.getElementById('githubToken').value = token;
            }
        }

        // ========== æ•°æ®ç®¡ç† ==========
        function loadFromStorage() {
            loadTempToken();

            const stored = localStorage.getItem('lg_admin_data');
            if (stored) {
                appData = JSON.parse(stored);
            } else {
                initDefaultData();
            }
            updateAllUI();
        }

        function initDefaultData() {
            appData.banners = [];
            appData.posters.index = [{},{},{}];
            appData.posters.cn = [{},{},{}];
            appData.posters.events = [{},{},{}];
            appData.events = [];
            appData.partners = [{},{},{},{}];
            appData.collaborators = [];
            appData.footer.global = {
                copyright: "Â© 2026 LIVEGIGS ASIA. ALL RIGHTS RESERVED.",
                social: [
                    {name: "Facebook", url: "https://facebook.com/livegigsasia", icon: "facebook"},
                    {name: "Instagram", url: "https://instagram.com/livegigsasia", icon: "instagram"},
                    {name: "YouTube", url: "https://youtube.com/livegigsasia", icon: "youtube"},
                    {name: "X", url: "https://x.com/livegigsasia", icon: "x"}
                ],
                producer: "./image/emanonent-logo.png"
            };
            appData.footer.cn = {
                copyright: "Â© 2026 LIVEGIGS ASIA. ç‰ˆæƒæ‰€æœ‰.",
                social: [
                    {name: "å¾®ä¿¡", url: "https://weixin.qq.com/livegigsasia", icon: "wechat"},
                    {name: "å¾®åš", url: "https://weibo.com/livegigsasia", icon: "weibo"}
                ],
                producer: "./image/emanonent-logo.png"
            };
            saveToStorage();
        }

        function saveToStorage() {
            localStorage.setItem('lg_admin_data', JSON.stringify(appData));
        }

        function showAlert(message, type = 'info') {
            const container = document.getElementById('alertContainer');
            container.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
            setTimeout(() => container.innerHTML = '', 5000);
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // ========== Banner ç®¡ç† ==========
        function loadBanners() {
            const list = document.getElementById('bannerList');
            if (!appData.banners.length) {
                list.innerHTML = '<p style="color: #666;">æš‚æ—  Banner</p>';
                return;
            }

            const sorted = [...appData.banners].sort((a,b) => (a.order||0) - (b.order||0));

            list.innerHTML = sorted.map((b, i) => `
                <div class="item-card">
                    <div class="item-info">
                        <h4>${b.title} <span class="status-badge ${b.active!==false?'status-active':'status-inactive'}">${b.active!==false?'å¯ç”¨':'ç¦ç”¨'}</span></h4>
                        <p>æ’åº: ${b.order || '-'} | é“¾æ¥: ${b.link || '-'}</p>
                    </div>
                    <div class="item-actions">
                        <button class="btn-small btn-edit" onclick="editBanner(${i})">ç¼–è¾‘</button>
                        <button class="btn-small btn-delete" onclick="deleteBanner(${i})">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        async function saveBanner() {
            const editIndex = document.getElementById('bannerEditIndex').value;
            const banner = {
                title: document.getElementById('bannerTitle').value,
                image: document.getElementById('bannerImage').value,
                button_text: document.getElementById('bannerButton').value,
                link: document.getElementById('bannerLink').value,
                order: parseInt(document.getElementById('bannerOrder').value) || 1,
                active: document.getElementById('bannerActive').checked
            };

            if (!banner.title || !banner.image) {
                showAlert('è¯·å¡«å†™æ ‡é¢˜å’Œå›¾ç‰‡åœ°å€', 'error');
                return;
            }

            if (editIndex !== '') {
                appData.banners[parseInt(editIndex)] = banner;
            } else {
                appData.banners.push(banner);
            }

            saveToStorage();

            // åŒæ­¥åˆ°GitHub
            try {
                await commitToGitHub(CONFIG.files.banners, appData.banners, 'Update banners');
                resetBannerForm();
                loadBanners();
                showAlert('Banner ä¿å­˜å¹¶åŒæ­¥æˆåŠŸï¼', 'success');
            } catch (e) {
                showAlert('ä¿å­˜æˆåŠŸä½†åŒæ­¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        function resetBannerForm() {
            document.getElementById('bannerForm').reset();
            document.getElementById('bannerEditIndex').value = '';
        }

        function editBanner(index) {
            const b = appData.banners[index];
            document.getElementById('bannerEditIndex').value = index;
            document.getElementById('bannerTitle').value = b.title;
            document.getElementById('bannerImage').value = b.image;
            document.getElementById('bannerButton').value = b.button_text || '';
            document.getElementById('bannerLink').value = b.link || '';
            document.getElementById('bannerOrder').value = b.order || 1;
            document.getElementById('bannerActive').checked = b.active !== false;
        }

        async function deleteBanner(index) {
            if (!confirm('ç¡®å®šåˆ é™¤?')) return;
            appData.banners.splice(index, 1);
            saveToStorage();

            try {
                await commitToGitHub(CONFIG.files.banners, appData.banners, 'Delete banner');
                loadBanners();
                showAlert('åˆ é™¤å¹¶åŒæ­¥æˆåŠŸ', 'success');
            } catch (e) {
                loadBanners();
                showAlert('æœ¬åœ°åˆ é™¤æˆåŠŸï¼ŒåŒæ­¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        // ========== æµ·æŠ¥ç®¡ç† ==========
        let currentPosterPage = 'index';

        function switchPosterPage() {
            currentPosterPage = document.getElementById('posterPage').value;
            const container = document.getElementById('posterForms');
            const posters = appData.posters[currentPosterPage] || [{},{},{}];

            let html = '';

            // æµ·æŠ¥1å’Œ3ï¼ˆå•å›¾ï¼‰
            [0, 2].forEach(i => {
                const p = posters[i] || {};
                html += `
                    <div class="card">
                        <h3 style="color: #8b0000; margin-bottom: 20px;">æµ·æŠ¥ ${i+1}</h3>
                        <div class="form-group">
                            <label>æ ‡é¢˜</label>
                            <input type="text" id="poster${i}_title" value="${p.title||''}">
                        </div>
                        <div class="form-group">
                            <label>å›¾ç‰‡åœ°å€</label>
                            <input type="text" id="poster${i}_image" value="${p.image||''}" placeholder="./image/poster.jpg æˆ– https://...">
                        </div>
                        <div class="grid-2">
                            <div class="form-group">
                                <label>é“¾æ¥æ–‡å­—</label>
                                <input type="text" id="poster${i}_linkText" value="${p.link_text||''}">
                            </div>
                            <div class="form-group">
                                <label>é“¾æ¥åœ°å€</label>
                                <input type="text" id="poster${i}_link" value="${p.link||''}" placeholder="./events.html æˆ– https://...">
                            </div>
                        </div>
                    </div>
                `;
            });

            // æµ·æŠ¥2ï¼ˆç‰¹æ®Šå¤„ç†ï¼‰
            const p2 = posters[1] || {};
            if (currentPosterPage === 'events') {
                html += `
                    <div class="card">
                        <h3 style="color: #8b0000; margin-bottom: 20px;">æµ·æŠ¥ 2 - æ»šæ’­æ¨¡å¼ (æœ€å¤š5ä¸ª)</h3>
                        <div class="form-group">
                            <label>åŒºåŸŸæ ‡é¢˜</label>
                            <input type="text" id="poster2_title" value="${p2.title||'Epic Past Gigs'}">
                        </div>
                        <div id="carouselItems">
                            ${(p2.carousel_images || []).map((img, idx) => `
                                <div class="carousel-item" data-index="${idx}">
                                    <h4>æ»šæ’­å›¾ ${idx+1}</h4>
                                    <div class="form-group">
                                        <label>æ ‡é¢˜</label>
                                        <input type="text" class="carousel-title" value="${img.title||''}">
                                    </div>
                                    <div class="form-group">
                                        <label>å›¾ç‰‡åœ°å€</label>
                                        <input type="text" class="carousel-image" value="${img.image||''}" placeholder="./image/gig.jpg æˆ– https://...">
                                    </div>
                                    <div class="grid-2">
                                        <div class="form-group">
                                            <label>é“¾æ¥æ–‡å­—</label>
                                            <input type="text" class="carousel-linkText" value="${img.link_text||''}">
                                        </div>
                                        <div class="form-group">
                                            <label>é“¾æ¥åœ°å€</label>
                                            <input type="text" class="carousel-link" value="${img.link||''}" placeholder="./event.html æˆ– https://...">
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-delete" onclick="removeCarouselItem(this)">åˆ é™¤æ­¤å›¾</button>
                                </div>
                            `).join('')}
                        </div>
                        <button type="button" class="btn" onclick="addCarouselItem()" id="addCarouselBtn">æ·»åŠ æ»šæ’­å›¾ (æœ€å¤š5ä¸ª)</button>
                    </div>
                `;
            } else {
                html += `
                    <div class="card">
                        <h3 style="color: #8b0000; margin-bottom: 20px;">æµ·æŠ¥ 2 - å•å›¾æ¨¡å¼</h3>
                        <div class="form-group">
                            <label>æ ‡é¢˜</label>
                            <input type="text" id="poster2_title" value="${p2.title||''}">
                        </div>
                        <div class="form-group">
                            <label>å›¾ç‰‡åœ°å€</label>
                            <input type="text" id="poster2_image" value="${p2.image||''}" placeholder="./image/poster.jpg æˆ– https://...">
                        </div>
                        <div class="grid-2">
                            <div class="form-group">
                                <label>é“¾æ¥æ–‡å­—</label>
                                <input type="text" id="poster2_linkText" value="${p2.link_text||''}">
                            </div>
                            <div class="form-group">
                                <label>é“¾æ¥åœ°å€</label>
                                <input type="text" id="poster2_link" value="${p2.link||''}" placeholder="./events.html æˆ– https://...">
                            </div>
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function addCarouselItem() {
            const container = document.getElementById('carouselItems');
            const count = container.querySelectorAll('.carousel-item').length;

            if (count >= 5) {
                showAlert('æœ€å¤šåªèƒ½æ·»åŠ 5ä¸ªæ»šæ’­å›¾', 'error');
                return;
            }

            const div = document.createElement('div');
            div.className = 'carousel-item';
            div.innerHTML = `
                <h4>æ»šæ’­å›¾ ${count+1}</h4>
                <div class="form-group">
                    <label>æ ‡é¢˜</label>
                    <input type="text" class="carousel-title">
                </div>
                <div class="form-group">
                    <label>å›¾ç‰‡åœ°å€</label>
                    <input type="text" class="carousel-image" placeholder="./image/gig.jpg æˆ– https://...">
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>é“¾æ¥æ–‡å­—</label>
                        <input type="text" class="carousel-linkText">
                    </div>
                    <div class="form-group">
                        <label>é“¾æ¥åœ°å€</label>
                        <input type="text" class="carousel-link" placeholder="./event.html æˆ– https://...">
                    </div>
                </div>
                <button type="button" class="btn btn-delete" onclick="removeCarouselItem(this)">åˆ é™¤æ­¤å›¾</button>
            `;
            container.appendChild(div);

            if (count + 1 >= 5) {
                document.getElementById('addCarouselBtn').style.display = 'none';
            }
        }

        function removeCarouselItem(btn) {
            btn.closest('.carousel-item').remove();
            document.getElementById('addCarouselBtn').style.display = 'inline-block';
            document.querySelectorAll('.carousel-item h4').forEach((h4, i) => {
                h4.textContent = `æ»šæ’­å›¾ ${i+1}`;
            });
        }

        async function savePosters() {
            const posters = [{}, {}, {}];

            // æµ·æŠ¥1
            posters[0] = {
                title: document.getElementById('poster0_title').value,
                image: document.getElementById('poster0_image').value,
                link_text: document.getElementById('poster0_linkText').value,
                link: document.getElementById('poster0_link').value
            };

            // æµ·æŠ¥2
            if (currentPosterPage === 'events') {
                const carouselImages = [];
                document.querySelectorAll('.carousel-item').forEach(item => {
                    carouselImages.push({
                        title: item.querySelector('.carousel-title').value,
                        image: item.querySelector('.carousel-image').value,
                        link_text: item.querySelector('.carousel-linkText').value,
                        link: item.querySelector('.carousel-link').value
                    });
                });
                posters[1] = {
                    title: document.getElementById('poster2_title').value,
                    carousel: true,
                    carousel_images: carouselImages
                };
            } else {
                posters[1] = {
                    title: document.getElementById('poster2_title').value,
                    image: document.getElementById('poster2_image').value,
                    link_text: document.getElementById('poster2_linkText').value,
                    link: document.getElementById('poster2_link').value,
                    carousel: false
                };
            }

            // æµ·æŠ¥3ï¼ˆä»ç¬¬3ä¸ªcardè¯»å–ï¼‰
            const poster3Card = document.querySelectorAll('#posterForms .card')[2];
            if (poster3Card) {
                const inputs = poster3Card.querySelectorAll('input');
                if (inputs.length >= 4) {
                    posters[2] = {
                        title: inputs[0].value,
                        image: inputs[1].value,
                        link_text: inputs[2].value,
                        link: inputs[3].value
                    };
                }
            }

            appData.posters[currentPosterPage] = posters;
            saveToStorage();

            // åŒæ­¥åˆ°GitHub
            try {
                const fileMap = {
                    'index': CONFIG.files.indexPosters,
                    'cn': CONFIG.files.cnPosters,
                    'events': CONFIG.files.eventsPosters
                };
                await commitToGitHub(fileMap[currentPosterPage], posters, `Update ${currentPosterPage} posters`);
                showAlert('æµ·æŠ¥ä¿å­˜å¹¶åŒæ­¥æˆåŠŸï¼', 'success');
            } catch (e) {
                showAlert('ä¿å­˜æˆåŠŸä½†åŒæ­¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        // ========== æ´»åŠ¨ç®¡ç† ==========
        function loadEvents() {
            const list = document.getElementById('eventList');
            if (!appData.events.length) {
                list.innerHTML = '<p style="color: #666;">æš‚æ— æ´»åŠ¨</p>';
                return;
            }

            list.innerHTML = appData.events.map((e, i) => `
                <div class="item-card">
                    <div class="item-info">
                        <h4>${e.title} ${e.status?`<span class="status-badge ${e.status==='soldout'?'status-inactive':'status-active'}">${e.status}</span>`:''}</h4>
                        <p>${e.date || '-'} | ${e.location || '-'} | ${e.ticket || '-'}</p>
                    </div>
                    <div class="item-actions">
                        <button class="btn-small btn-edit" onclick="editEvent(${i})">ç¼–è¾‘</button>
                        <button class="btn-small btn-delete" onclick="deleteEvent(${i})">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        async function saveEvent() {
            const editIndex = document.getElementById('eventEditIndex').value;
            const event = {
                title: document.getElementById('eventTitle').value,
                date: document.getElementById('eventDate').value,
                location: document.getElementById('eventLocation').value,
                time: document.getElementById('eventTime').value,
                image: document.getElementById('eventImage').value,
                ticket: document.getElementById('eventTicket').value,
                status: document.getElementById('eventStatus').value,
                description: document.getElementById('eventDesc').value,
                button_text: document.getElementById('eventButton').value,
                link: document.getElementById('eventLink').value
            };

            if (!event.title || !event.image || !event.date) {
                showAlert('è¯·å¡«å†™æ ‡é¢˜ã€å›¾ç‰‡å’Œæ—¥æœŸ', 'error');
                return;
            }

            if (editIndex !== '') {
                appData.events[parseInt(editIndex)] = event;
            } else {
                appData.events.push(event);
            }

            saveToStorage();

            try {
                await commitToGitHub(CONFIG.files.eventsManaged, appData.events, 'Update events');
                resetEventForm();
                loadEvents();
                showAlert('æ´»åŠ¨ä¿å­˜å¹¶åŒæ­¥æˆåŠŸï¼', 'success');
            } catch (e) {
                showAlert('ä¿å­˜æˆåŠŸä½†åŒæ­¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        function resetEventForm() {
            document.getElementById('eventForm').reset();
            document.getElementById('eventEditIndex').value = '';
        }

        function editEvent(index) {
            const e = appData.events[index];
            document.getElementById('eventEditIndex').value = index;
            document.getElementById('eventTitle').value = e.title;
            document.getElementById('eventDate').value = e.date;
            document.getElementById('eventLocation').value = e.location || '';
            document.getElementById('eventTime').value = e.time || '';
            document.getElementById('eventImage').value = e.image;
            document.getElementById('eventTicket').value = e.ticket || '';
            document.getElementById('eventStatus').value = e.status || '';
            document.getElementById('eventDesc').value = e.description || '';
            document.getElementById('eventButton').value = e.button_text || '';
            document.getElementById('eventLink').value = e.link || '';
        }

        async function deleteEvent(index) {
            if (!confirm('ç¡®å®šåˆ é™¤?')) return;
            appData.events.splice(index, 1);
            saveToStorage();

            try {
                await commitToGitHub(CONFIG.files.eventsManaged, appData.events, 'Delete event');
                loadEvents();
                showAlert('åˆ é™¤å¹¶åŒæ­¥æˆåŠŸ', 'success');
            } catch (e) {
                loadEvents();
                showAlert('æœ¬åœ°åˆ é™¤æˆåŠŸï¼ŒåŒæ­¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        // ========== åˆä½œä¼™ä¼´ ==========
        function loadPartnerBanners() {
            const container = document.getElementById('partnerBanners');
            container.innerHTML = appData.partners.map((b, i) => `
                <div class="card" style="margin-bottom: 15px;">
                    <h4 style="color: #8b0000; margin-bottom: 15px;">Banner ${i+1}</h4>
                    <div class="form-group">
                        <label>èƒŒæ™¯å›¾</label>
                        <input type="text" id="partner${i}_bg" value="${b.background||''}" placeholder="./image/p-p-${i+1}.jpg">
                    </div>
                    <div class="form-group">
                        <label>Logo</label>
                        <input type="text" id="partner${i}_logo" value="${b.logo||''}" placeholder="./image/p-p-${i+1}logo.png">
                    </div>
                    <div class="form-group">
                        <label>æ ‡é¢˜</label>
                        <input type="text" id="partner${i}_title" value="${b.title||''}">
                    </div>
                    <div class="form-group">
                        <label>æè¿°</label>
                        <input type="text" id="partner${i}_desc" value="${b.description||''}">
                    </div>
                    <div class="grid-2">
                        <div class="form-group">
                            <label>æŒ‰é’®æ–‡å­—</label>
                            <input type="text" id="partner${i}_btn" value="${b.button_text||''}">
                        </div>
                        <div class="form-group">
                            <label>é“¾æ¥</label>
                            <input type="text" id="partner${i}_link" value="${b.link||''}" placeholder="./partner.html æˆ– https://...">
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function savePartners() {
            appData.partners = appData.partners.map((_, i) => ({
                background: document.getElementById(`partner${i}_bg`).value,
                logo: document.getElementById(`partner${i}_logo`).value,
                title: document.getElementById(`partner${i}_title`).value,
                description: document.getElementById(`partner${i}_desc`).value,
                button_text: document.getElementById(`partner${i}_btn`).value,
                link: document.getElementById(`partner${i}_link`).value
            }));
            saveToStorage();

            try {
                await commitToGitHub(CONFIG.files.partnersBanners, appData.partners, 'Update partners');
                await commitToGitHub(CONFIG.files.collaborators, appData.collaborators, 'Update collaborators');
                showAlert('åˆä½œä¼™ä¼´ä¿å­˜å¹¶åŒæ­¥æˆåŠŸï¼', 'success');
            } catch (e) {
                showAlert('ä¿å­˜æˆåŠŸä½†åŒæ­¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        function loadCollaborators() {
            const list = document.getElementById('collabList');
            const count = document.getElementById('collabCount');

            count.textContent = appData.collaborators.length;

            if (!appData.collaborators.length) {
                list.innerHTML = '<p style="color: #666;">æš‚æ—  Logo</p>';
                return;
            }

            list.innerHTML = appData.collaborators.map((logo, i) => `
                <div style="position: relative;">
                    <img src="${logo}" style="width: 100px; height: 60px; object-fit: contain; background: #1a1a1a; padding: 10px; border-radius: 4px;" onerror="this.style.display='none'">
                    <button onclick="deleteCollaborator(${i})" style="position: absolute; top: -5px; right: -5px; background: #8b0000; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer;">Ã—</button>
                </div>
            `).join('');
        }

        async function addCollaborator() {
            const logo = document.getElementById('collabLogo').value.trim();
            if (!logo) return;

            appData.collaborators.push(logo);
            saveToStorage();
            document.getElementById('collabLogo').value = '';
            loadCollaborators();

            showAlert('Logo å·²æ·»åŠ ï¼Œç‚¹å‡»"ä¿å­˜åˆä½œä¼™ä¼´å¹¶åŒæ­¥"æäº¤åˆ°GitHub', 'info');
        }

        function deleteCollaborator(index) {
            appData.collaborators.splice(index, 1);
            saveToStorage();
            loadCollaborators();
        }

        // ========== Footer ç®¡ç† ==========
        function loadFooter() {
            const site = document.getElementById('footerSite').value;
            const data = appData.footer[site] || {};

            document.getElementById('footerCopyright').value = data.copyright || '';
            document.getElementById('footerSocial').value = JSON.stringify(data.social || [], null, 2);
            document.getElementById('footerProducer').value = data.producer || '';
        }

        async function saveFooter() {
            const site = document.getElementById('footerSite').value;
            try {
                appData.footer[site] = {
                    copyright: document.getElementById('footerCopyright').value,
                    social: JSON.parse(document.getElementById('footerSocial').value),
                    producer: document.getElementById('footerProducer').value
                };
                saveToStorage();

                await commitToGitHub(CONFIG.files.footer, appData.footer, 'Update footer');
                showAlert('åº•éƒ¨è®¾ç½®ä¿å­˜å¹¶åŒæ­¥æˆåŠŸï¼', 'success');
            } catch (e) {
                showAlert('ä¿å­˜æˆåŠŸä½†åŒæ­¥å¤±è´¥: ' + e.message, 'error');
            }
        }

        // ========== åŒæ­¥æ‰€æœ‰æ–‡ä»¶ ==========
        async function syncAllFiles() {
            const config = getGitHubConfig();
            if (!config.token) {
                showAlert('è¯·å…ˆè¾“å…¥ GitHub Token', 'error');
                return;
            }

            const files = [
                { path: CONFIG.files.banners, data: appData.banners, msg: 'Sync all - banners' },
                { path: CONFIG.files.indexPosters, data: appData.posters.index, msg: 'Sync all - index posters' },
                { path: CONFIG.files.cnPosters, data: appData.posters.cn, msg: 'Sync all - cn posters' },
                { path: CONFIG.files.eventsPosters, data: appData.posters.events, msg: 'Sync all - events posters' },
                { path: CONFIG.files.eventsManaged, data: appData.events, msg: 'Sync all - events' },
                { path: CONFIG.files.partnersBanners, data: appData.partners, msg: 'Sync all - partners' },
                { path: CONFIG.files.collaborators, data: appData.collaborators, msg: 'Sync all - collaborators' },
                { path: CONFIG.files.footer, data: appData.footer, msg: 'Sync all - footer' }
            ];

            const progressBar = document.getElementById('syncProgress');
            const progressFill = document.getElementById('syncProgressFill');
            progressBar.classList.add('show');

            let success = 0;
            let failed = 0;

            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                progressFill.style.width = `${((i + 1) / files.length) * 100}%`;

                try {
                    await commitToGitHub(file.path, file.data, file.msg);
                    success++;
                } catch (e) {
                    failed++;
                    console.error(`Failed to sync ${file.path}:`, e);
                }
            }

            setTimeout(() => {
                progressBar.classList.remove('show');
                progressFill.style.width = '0%';
            }, 1000);

            showAlert(`åŒæ­¥å®Œæˆ! æˆåŠŸ: ${success}, å¤±è´¥: ${failed}`, failed === 0 ? 'success' : 'error');
            updateSyncStatus();
        }

        function updateSyncStatus() {
            const list = document.getElementById('syncStatusList');
            const files = [
                { name: 'banners.json', data: appData.banners },
                { name: 'index-posters.json', data: appData.posters.index },
                { name: 'cn-posters.json', data: appData.posters.cn },
                { name: 'events-posters.json', data: appData.posters.events },
                { name: 'events-managed.json', data: appData.events },
                { name: 'partners-banners.json', data: appData.partners },
                { name: 'collaborators.json', data: appData.collaborators },
                { name: 'footer.json', data: appData.footer }
            ];

            list.innerHTML = files.map(f => {
                const hasData = Array.isArray(f.data) ? f.data.length > 0 : Object.keys(f.data).length > 0;
                return `
                    <div class="item-card" style="padding: 10px; margin-bottom: 5px;">
                        <div class="item-info">
                            <h4 style="font-size: 14px;">${f.name}</h4>
                            <p style="font-size: 12px;">${hasData ? 'âœ“ æœ‰æ•°æ®' : 'â—‹ æ— æ•°æ®'}</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ========== UI æ›´æ–° ==========
        function updateAllUI() {
            loadBanners();
            switchPosterPage();
            loadEvents();
            loadPartnerBanners();
            loadCollaborators();
            loadFooter();
            updateSyncStatus();
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', loadFromStorage);
    </script>
</body>
</html>