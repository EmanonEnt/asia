<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveGigs Asia - 后台管理</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-red: #8b0000;
            --silver: #c0c0c0;
            --dark-bg: #1a1a1a;
            --light-silver: #e8e8e8;
            --text-dark: #1a1a1a;
            --text-muted: #555555;
        }

        body {
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
            background: linear-gradient(135deg, #d0d0d0 0%, #c0c0c0 100%);
            color: var(--text-dark);
            min-height: 100vh;
        }

        /* 登录页面 */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #d0d0d0 0%, #c0c0c0 100%);
        }

        .login-box {
            box-shadow: 0 0 30px rgba(139, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.95);
            border: 3px solid var(--primary-red);
            padding: 60px;
            border-radius: 10px;
            text-align: center;
            min-width: 400px;
        }

        .login-box h1 {
            text-shadow: 0 0 10px rgba(139, 0, 0, 0.5);
            color: var(--primary-red);
            font-size: 42px;
            margin-bottom: 10px;
            letter-spacing: 4px;
        }

        .login-box h2 {
            color: #333333;
            font-size: 18px;
            margin-bottom: 40px;
            font-weight: normal;
        }

        .form-group {
            margin-bottom: 25px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333333;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            background: #ffffff;
            border: 2px solid var(--primary-red);
            color: #1a1a1a;
            font-size: 16px;
            font-family: inherit;
            border-radius: 5px;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-red);
        }

        .btn {
            box-shadow: 0 4px 15px rgba(139, 0, 0, 0.4);
            padding: 15px 40px;
            background: var(--primary-red);
            color: white;
            border: none;
            font-size: 16px;
            font-family: inherit;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .btn:hover {
            box-shadow: 0 6px 20px rgba(139, 0, 0, 0.6);
            background: #a00000;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--primary-red);
            color: var(--primary-red);
        }

        .btn-secondary:hover {
            background: rgba(139, 0, 0, 0.1);
        }

        .btn-success {
            background: #28a745;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
        }

        .btn-success:hover {
            background: #218838;
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.6);
        }

        .btn-danger {
            background: #dc3545;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
        }

        .btn-small {
            padding: 10px 25px;
            font-size: 12px;
        }

        /* 后台主界面 */
        .admin-container {
            display: none;
        }

        .admin-header {
            background: rgba(30, 30, 30, 0.95);
            border-bottom: 3px solid var(--primary-red);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .admin-header h1 {
            color: var(--primary-red);
            font-size: 28px;
            letter-spacing: 3px;
        }

        .admin-header .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sync-status {
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 12px;
            letter-spacing: 1px;
            font-family: Arial, sans-serif;
        }

        .sync-status.pending {
            background: #ffc107;
            color: #000;
        }

        .sync-status.success {
            background: #28a745;
            color: white;
        }

        .sync-status.error {
            background: #dc3545;
            color: white;
        }

        .admin-sidebar {
            position: fixed;
            left: 0;
            top: 80px;
            bottom: 0;
            width: 280px;
            background: rgba(40, 40, 40, 0.95);
            border-right: 1px solid var(--primary-red);
            overflow-y: auto;
            padding: 20px 0;
        }

        .nav-item {
            padding: 18px 30px;
            cursor: pointer;
            border-left: 4px solid transparent;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 14px;
            color: #f0f0f0;
            text-decoration: none;
            display: block;
        }

        .nav-item:hover {
            background: rgba(139, 0, 0, 0.3);
            border-left-color: var(--primary-red);
            color: #ffffff;
        }

        .nav-item.active {
            background: rgba(139, 0, 0, 0.4);
            border-left-color: var(--primary-red);
            color: #ffffff;
            font-weight: bold;
        }

        .nav-item .count {
            float: right;
            background: var(--primary-red);
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 11px;
        }

        .admin-content {
            margin-left: 280px;
            margin-top: 80px;
            padding: 40px;
            min-height: calc(100vh - 80px);
            color: #1a1a1a;
            scroll-behavior: smooth;
        }

        .section {
            scroll-margin-top: 100px;
            margin-bottom: 60px;
            display: none;
        }

        .section.active {
            display: block;
        }

        .section-title {
            font-size: 32px;
            color: #8b0000;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #8b0000;
            letter-spacing: 3px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-desc {
            color: #555555;
            margin-bottom: 30px;
            font-size: 14px;
            letter-spacing: 1px;
        }

        /* 数据表格 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.9);
        }

        .data-table th {
            background: rgba(139, 0, 0, 0.1);
            padding: 15px;
            text-align: left;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 12px;
            border-bottom: 2px solid #8b0000;
            color: #1a1a1a;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(139, 0, 0, 0.2);
            vertical-align: top;
            color: #1a1a1a;
        }

        .data-table tr:hover td {
            background: rgba(255, 255, 255, 1);
        }

        .data-table tr.disabled {
            opacity: 0.4;
            background: rgba(0, 0, 0, 0.05);
        }

        .data-table input,
        .data-table textarea {
            width: 100%;
            padding: 10px;
            background: #ffffff;
            border: 1px solid #8b0000;
            color: #1a1a1a;
            font-family: Arial, sans-serif;
            font-size: 13px;
            border-radius: 3px;
        }

        .data-table input:focus,
        .data-table textarea:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 5px rgba(139, 0, 0, 0.3);
        }

        .data-table textarea {
            min-height: 60px;
            resize: vertical;
        }

        .data-table input[type="checkbox"] {
            width: auto;
            transform: scale(1.3);
            cursor: pointer;
        }

        .data-table .order-input {
            width: 60px;
            text-align: center;
        }

        .data-table .img-preview {
            width: 80px;
            height: 50px;
            object-fit: cover;
            border: 1px solid var(--primary-red);
            border-radius: 3px;
        }

        /* 标签页 */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #8b0000;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            color: #555555;
            background: transparent;
            border: none;
            font-family: inherit;
            font-size: 14px;
        }

        .tab:hover {
            color: #8b0000;
        }

        .tab.active {
            color: #8b0000;
            border-bottom-color: #8b0000;
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* 工具栏 */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 5px;
            border: 1px solid rgba(139, 0, 0, 0.2);
        }

        .toolbar-left {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .toolbar-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .last-sync {
            color: #666;
            font-size: 12px;
            font-family: Arial, sans-serif;
        }

        /* 提示信息 */
        .alert {
            padding: 15px 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
            font-family: Arial, sans-serif;
        }

        .alert.show {
            display: block;
        }

        .alert-success {
            background: rgba(40, 167, 69, 0.15);
            border: 1px solid #28a745;
            color: #155724;
        }

        .alert-error {
            background: rgba(220, 53, 69, 0.15);
            border: 1px solid #dc3545;
            color: #721c24;
        }

        .alert-warning {
            background: rgba(255, 193, 7, 0.15);
            border: 1px solid #ffc107;
            color: #856404;
        }

        /* 添加按钮 */
        .add-row-btn {
            margin-top: 20px;
            padding: 15px;
            width: 100%;
            background: rgba(139, 0, 0, 0.05);
            border: 2px dashed #8b0000;
            color: #8b0000;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: all 0.3s;
            border-radius: 5px;
        }

        .add-row-btn:hover {
            background: rgba(139, 0, 0, 0.15);
            border-style: solid;
        }

        /* 统计卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--primary-red);
            padding: 25px;
            border-radius: 5px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 36px;
            color: #8b0000;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #555555;
        }

        /* 区域同步按钮 */
        .section-sync-btn {
            font-size: 12px;
            padding: 10px 20px;
        }

        /* 响应式 */
        @media (max-width: 1024px) {
            .admin-sidebar {
                width: 100%;
                position: relative;
                top: 0;
            }

            .admin-content {
                margin-left: 0;
            }

            .data-table {
                font-size: 12px;
            }

            .data-table th,
            .data-table td {
                padding: 10px 5px;
            }
        }

        /* 模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: #f0f0f0;
            border: 3px solid var(--primary-red);
            padding: 40px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .modal-content h3 {
            color: #8b0000;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .modal-content p {
            margin-bottom: 30px;
            line-height: 1.6;
            color: #333;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        /* 同步状态指示器 */
        .sync-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #666;
        }

        .sync-indicator.syncing::before {
            content: "";
            width: 12px;
            height: 12px;
            border: 2px solid #8b0000;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- 登录页面 -->
    <div class="login-container" id="loginPage">
        <div class="login-box">
            <h1>LIVEGIGS</h1>
            <h2>ASIA ADMIN PANEL</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="username" value="admin" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" placeholder="Enter password" required>
                </div>
                <div class="form-group">
                    <label>GitHub Token (Optional)</label>
                    <input type="text" id="githubToken" placeholder="ghp_xxxxxxxxxxxx">
                </div>
                <button type="submit" class="btn">Login</button>
            </form>
        </div>
    </div>

    <!-- 后台主界面 -->
    <div class="admin-container" id="adminPanel">
        <header class="admin-header">
            <h1>LIVEGIGS ASIA ADMIN</h1>
            <div class="user-info">
                <span id="syncStatus" class="sync-status pending">未同步</span>
                <span id="lastSync" class="last-sync"></span>
                <button class="btn btn-small" onclick="syncAllToGitHub()">全站同步</button>
                <button class="btn btn-small btn-secondary" onclick="downloadAllData()">下载备份</button>
                <button class="btn btn-small btn-danger" onclick="logout()">退出</button>
            </div>
        </header>

        <nav class="admin-sidebar">
            <a href="#dashboard" class="nav-item active" data-section="dashboard" onclick="showSection('dashboard'); return false;">
                Dashboard
                <span class="count" id="dashboardCount">0</span>
            </a>
            <a href="#banners" class="nav-item" data-section="banners" onclick="showSection('banners'); return false;">
                1. Banner管理
                <span class="count" id="bannerCount">0</span>
            </a>
            <a href="#posters" class="nav-item" data-section="posters" onclick="showSection('posters'); return false;">
                2. 海报管理
                <span class="count" id="posterCount">0</span>
            </a>
            <a href="#events" class="nav-item" data-section="events" onclick="showSection('events'); return false;">
                3. 自主活动
                <span class="count" id="eventCount">0</span>
            </a>
            <a href="#carousel" class="nav-item" data-section="carousel" onclick="showSection('carousel'); return false;">
                4. 滚播活动
                <span class="count" id="carouselCount">0</span>
            </a>
            <a href="#footer" class="nav-item" data-section="footer" onclick="showSection('footer'); return false;">
                5. 底部管理
                <span class="count" id="footerCount">-</span>
            </a>
            <a href="#partners" class="nav-item" data-section="partners" onclick="showSection('partners'); return false;">
                6. 合作伙伴
                <span class="count" id="partnerCount">0</span>
            </a>
        </nav>

        <main class="admin-content">
            <div id="alertBox" class="alert"></div>

            <!-- Dashboard -->
            <section id="dashboard" class="section active">
                <h2 class="section-title">Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="statBanners">0</h3>
                        <p>Banners</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="statPosters">0</h3>
                        <p>Posters</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="statEvents">0</h3>
                        <p>自主活動</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="statCarousel">0</h3>
                        <p>滾播活動</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="statPartners">0</h3>
                        <p>合作Banner</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="statLogos">0</h3>
                        <p>合作Logo</p>
                    </div>
                </div>
                <div class="section-desc">
                    <p>欢迎使用 LiveGigs Asia 后台管理系统。</p>
                    <p>每个区域可以独立同步，也可以点击右上角"全站同步"一次性更新所有内容。</p>
                    <p>提示：所有字段都可以留空，留空的字段在前端不会显示（按钮不可点击）。</p>
                </div>
            </section>

            <!-- Banner管理 -->
            <section id="banners" class="section">
                <h2 class="section-title">
                    1. Banner管理 (Index + CN 同步)
                    <button class="btn btn-small btn-success section-sync-btn" onclick="syncSection('banners')">同步此区域</button>
                </h2>
                <p class="section-desc">最多5个Banner，Index和CN页面同步显示。尺寸：1920×1080px (16:9)。留空字段前端不显示。</p>

                <div class="toolbar">
                    <div class="toolbar-left">
                        <span>已启用: <strong id="enabledBanners">0</strong> / 5</span>
                    </div>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th width="50">启用</th>
                            <th width="60">排序</th>
                            <th>標題 (留空不顯示)</th>
                            <th>按鈕文字 (留空不顯示)</th>
                            <th>鏈接地址 (留空不點擊)</th>
                            <th>海報圖片</th>
                            <th width="80">預覽</th>
                        </tr>
                    </thead>
                    <tbody id="bannerTableBody">
                    </tbody>
                </table>
                <button class="add-row-btn" onclick="addBannerRow()">+ 添加Banner (最多5個)</button>
            </section>

            <!-- 海报管理 -->
            <section id="posters" class="section">
                <h2 class="section-title">
                    2. 海报管理
                    <button class="btn btn-small btn-success section-sync-btn" onclick="syncSection('posters')">同步此区域</button>
                </h2>

                <div class="tabs">
                    <button class="tab active" onclick="switchPosterTab('index')">Index頁面</button>
                    <button class="tab" onclick="switchPosterTab('cn')">CN頁面</button>
                    <button class="tab" onclick="switchPosterTab('events')">Events頁面</button>
                </div>

                <!-- Index海报 -->
                <div id="poster-index" class="tab-content active">
                    <p class="section-desc">Index頁面3個海報區域。尺寸：400×600px (2:3)。留空字段前端不显示。</p>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">啟用</th>
                                <th>標題 (留空不顯示)</th>
                                <th>鏈接文字 (留空不顯示)</th>
                                <th>鏈接地址 (留空不點擊)</th>
                                <th>海報圖片</th>
                                <th width="80">預覽</th>
                            </tr>
                        </thead>
                        <tbody id="indexPosterTableBody">
                        </tbody>
                    </table>
                </div>

                <!-- CN海报 -->
                <div id="poster-cn" class="tab-content">
                    <p class="section-desc">CN頁面3個海報區域。尺寸：400×600px (2:3)。留空字段前端不显示。</p>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">啟用</th>
                                <th>標題 (留空不顯示)</th>
                                <th>鏈接文字 (留空不顯示)</th>
                                <th>鏈接地址 (留空不點擊)</th>
                                <th>海報圖片</th>
                                <th width="80">預覽</th>
                            </tr>
                        </thead>
                        <tbody id="cnPosterTableBody">
                        </tbody>
                    </table>
                </div>

                <!-- Events海报 -->
                <div id="poster-events" class="tab-content">
                    <p class="section-desc">Events頁面海報2（可滾播）。尺寸：400×600px (2:3)，最多5個，≥2個時自動滾播。留空字段前端不显示。</p>

                    <div class="toolbar">
                        <div class="toolbar-left">
                            <label>
                                <input type="checkbox" id="poster2Carousel" onchange="togglePoster2Carousel()"> 
                                啟用海報2滾播模式 (≥2個海報時自動滾播)
                            </label>
                        </div>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">啟用</th>
                                <th>標題 (留空不顯示)</th>
                                <th>鏈接文字 (留空不顯示)</th>
                                <th>鏈接地址 (留空不點擊)</th>
                                <th>海報圖片</th>
                                <th width="80">預覽</th>
                            </tr>
                        </thead>
                        <tbody id="eventsPosterTableBody">
                        </tbody>
                    </table>
                    <button class="add-row-btn" onclick="addEventsPosterRow()">+ 添加海報 (最多5個)</button>
                </div>
            </section>

            <!-- 自主活动 -->
            <section id="events" class="section">
                <h2 class="section-title">
                    3. 自主活動管理
                    <button class="btn btn-small btn-success section-sync-btn" onclick="syncSection('events')">同步此区域</button>
                </h2>
                <p class="section-desc">Events頁面自主活動區域。最多9個，≤3個時不顯示Load More按鈕。尺寸：400×600px (2:3)。留空字段前端不显示。</p>

                <div class="toolbar">
                    <div class="toolbar-left">
                        <span>已啟用: <strong id="enabledEvents">0</strong> / 9</span>
                        <span style="margin-left: 20px;">Load More: <strong id="loadMoreStatus">隱藏</strong></span>
                    </div>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th width="50">啟用</th>
                            <th>標題 (留空不顯示)</th>
                            <th>日期</th>
                            <th>地點</th>
                            <th>時間</th>
                            <th>門票</th>
                            <th>狀態</th>
                            <th>按鈕 (留空不顯示)</th>
                            <th>鏈接 (留空不點擊)</th>
                            <th>海報</th>
                        </tr>
                    </thead>
                    <tbody id="eventsTableBody">
                    </tbody>
                </table>
                <button class="add-row-btn" onclick="addEventRow()">+ 添加活動 (最多9個)</button>
            </section>

            <!-- 滚播活动 -->
            <section id="carousel" class="section">
                <h2 class="section-title">
                    4. 滾播活動管理
                    <button class="btn btn-small btn-success section-sync-btn" onclick="syncSection('carousel')">同步此区域</button>
                </h2>
                <p class="section-desc">Events頁面滾播推薦區域。最少3個，最多12個。尺寸：1920×1080px (16:9)。留空字段前端不显示。</p>

                <div class="toolbar">
                    <div class="toolbar-left">
                        <span>已啟用: <strong id="enabledCarousel">0</strong> / 12</span>
                    </div>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th width="50">啟用</th>
                            <th width="60">排序</th>
                            <th>標題 (留空不顯示)</th>
                            <th>按鈕文字 (留空不顯示)</th>
                            <th>鏈接地址 (留空不點擊)</th>
                            <th>日期</th>
                            <th>海報圖片</th>
                            <th width="80">預覽</th>
                        </tr>
                    </thead>
                    <tbody id="carouselTableBody">
                    </tbody>
                </table>
                <button class="add-row-btn" onclick="addCarouselRow()">+ 添加滾播 (最多12個)</button>
            </section>

            <!-- 底部管理 -->
            <section id="footer" class="section">
                <h2 class="section-title">
                    5. 底部區域管理
                    <button class="btn btn-small btn-success section-sync-btn" onclick="syncSection('footer')">同步此区域</button>
                </h2>

                <div class="tabs">
                    <button class="tab active" onclick="switchFooterTab('global')">海外站 (Global)</button>
                    <button class="tab" onclick="switchFooterTab('cn')">國內站 (CN)</button>
                </div>

                <!-- 海外站底部 -->
                <div id="footer-global" class="tab-content active">
                    <p class="section-desc">Index/Events/Partners/Privacy/Accessibility 頁面共用此底部配置。留空字段前端不显示。</p>

                    <table class="data-table" style="margin-bottom: 30px;">
                        <thead>
                            <tr>
                                <th>配置項</th>
                                <th>內容 (留空使用默認值)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>站點名稱</td>
                                <td><input type="text" id="globalSiteName" value="LIVEGIGS" placeholder="LIVEGIGS"></td>
                            </tr>
                            <tr>
                                <td>站點副標 (紅色)</td>
                                <td><input type="text" id="globalSiteAsia" value="ASIA" placeholder="ASIA"></td>
                            </tr>
                            <tr>
                                <td>聯繫文字</td>
                                <td><textarea id="globalContactText" placeholder="聯繫文字">For inquiries and partnership opportunities, reach out to us at:</textarea></td>
                            </tr>
                            <tr>
                                <td>郵箱地址</td>
                                <td><input type="text" id="globalEmail" value="xrebooking@hotmail.com" placeholder="郵箱地址"></td>
                            </tr>
                            <tr>
                                <td>地址</td>
                                <td><input type="text" id="globalAddress" value="Hong Kong | Shanghai | Beijing" placeholder="地址"></td>
                            </tr>
                            <tr>
                                <td>版權文字</td>
                                <td><input type="text" id="globalCopyright" value="Copyright © 2001-2026 EMANON ENT" placeholder="版權文字"></td>
                            </tr>
                            <tr>
                                <td>製作單位Logo</td>
                                <td><input type="text" id="globalProducerLogo" value="./image/emanonent-logo.png" placeholder="./image/emanonent-logo.png"></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 style="color: #8b0000; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;">社交媒體 (最多10個，留空不顯示)</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">啟用</th>
                                <th>名稱</th>
                                <th>圖標類型</th>
                                <th>鏈接地址 (留空不點擊)</th>
                            </tr>
                        </thead>
                        <tbody id="globalSocialTableBody">
                        </tbody>
                    </table>
                    <button class="add-row-btn" onclick="addGlobalSocialRow()">+ 添加社交媒體</button>
                </div>

                <!-- 国内站底部 -->
                <div id="footer-cn" class="tab-content">
                    <p class="section-desc">CN頁面獨立底部配置。留空字段前端不显示。</p>

                    <table class="data-table" style="margin-bottom: 30px;">
                        <thead>
                            <tr>
                                <th>配置項</th>
                                <th>內容 (留空使用默認值)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>站點名稱</td>
                                <td><input type="text" id="cnSiteName" value="LIVEGIGS" placeholder="LIVEGIGS"></td>
                            </tr>
                            <tr>
                                <td>站點副標 (紅色)</td>
                                <td><input type="text" id="cnSiteAsia" value="CN" placeholder="CN"></td>
                            </tr>
                            <tr>
                                <td>聯繫文字</td>
                                <td><textarea id="cnContactText" placeholder="聯繫文字">如需咨询和合作机会，请联系我们：</textarea></td>
                            </tr>
                            <tr>
                                <td>郵箱地址</td>
                                <td><input type="text" id="cnEmail" value="xrebooking@hotmail.com" placeholder="郵箱地址"></td>
                            </tr>
                            <tr>
                                <td>地址</td>
                                <td><input type="text" id="cnAddress" value="香港 | 上海 | 北京" placeholder="地址"></td>
                            </tr>
                            <tr>
                                <td>版權文字</td>
                                <td><input type="text" id="cnCopyright" value="Copyright © 2001-2026 EMANON ENT" placeholder="版權文字"></td>
                            </tr>
                            <tr>
                                <td>製作單位Logo</td>
                                <td><input type="text" id="cnProducerLogo" value="./image/emanonent-logo.png" placeholder="./image/emanonent-logo.png"></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 style="color: #8b0000; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;">社交媒體 (最多10個，留空不顯示)</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">啟用</th>
                                <th>名稱</th>
                                <th>圖標類型</th>
                                <th>鏈接地址 (留空不點擊)</th>
                            </tr>
                        </thead>
                        <tbody id="cnSocialTableBody">
                        </tbody>
                    </table>
                    <button class="add-row-btn" onclick="addCnSocialRow()">+ 添加社交媒體</button>
                </div>
            </section>

            <!-- 合作伙伴 -->
            <section id="partners" class="section">
                <h2 class="section-title">
                    6. 合作夥伴管理
                    <button class="btn btn-small btn-success section-sync-btn" onclick="syncSection('partners')">同步此区域</button>
                </h2>

                <div class="tabs">
                    <button class="tab active" onclick="switchPartnerTab('banners')">合作Banner</button>
                    <button class="tab" onclick="switchPartnerTab('logos')">合作Logo</button>
                </div>

                <!-- 合作Banner -->
                <div id="partner-banners" class="tab-content active">
                    <p class="section-desc">Partners頁面Banner區域。最多9個。主海報：1920×800px，Logo：根據設計。留空字段前端不显示。</p>

                    <div class="toolbar">
                        <div class="toolbar-left">
                            <span>已啟用: <strong id="enabledPartnerBanners">0</strong> / 9</span>
                        </div>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">啟用</th>
                                <th>主海報</th>
                                <th>Logo圖</th>
                                <th>標題 (留空不顯示)</th>
                                <th>詳情 (留空不顯示)</th>
                                <th>按鈕文字 (留空不顯示)</th>
                                <th>鏈接 (留空不點擊)</th>
                            </tr>
                        </thead>
                        <tbody id="partnerBannerTableBody">
                        </tbody>
                    </table>
                    <button class="add-row-btn" onclick="addPartnerBannerRow()">+ 添加Banner (最多9個)</button>
                </div>

                <!-- 合作Logo -->
                <div id="partner-logos" class="tab-content">
                    <p class="section-desc">Partners頁面合作Logo區域。最多9個，>6個自動換行居中。尺寸：180×110px。留空链接则不可点击。</p>

                    <div class="toolbar">
                        <div class="toolbar-left">
                            <span>已啟用: <strong id="enabledPartnerLogos">0</strong> / 9</span>
                        </div>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="50">啟用</th>
                                <th>名稱</th>
                                <th>Logo圖片</th>
                                <th>鏈接地址 (留空則不可點擊)</th>
                            </tr>
                        </thead>
                        <tbody id="partnerLogoTableBody">
                        </tbody>
                    </table>
                    <button class="add-row-btn" onclick="addPartnerLogoRow()">+ 添加Logo (最多9個)</button>
                </div>
            </section>
        </main>
    </div>

    <!-- 确认模态框 -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3>確認操作</h3>
            <p id="confirmMessage">確定要執行此操作嗎？</p>
            <div class="modal-buttons">
                <button class="btn" onclick="confirmAction()">確定</button>
                <button class="btn btn-secondary" onclick="closeModal()">取消</button>
            </div>
        </div>
    </div>

    <script>

        // 全局数据存储
        let appData = {
            banners: { banners: [] },
            indexPosters: { posters: [] },
            cnPosters: { posters: [] },
            eventsPosters: { posters: [], poster2_carousel: false },
            eventsManaged: { events: [] },
            eventsCarousel: { carousel: [] },
            footerGlobal: { socials: [] },
            footerCN: { socials: [] },
            partnersBanners: { banners: [] },
            collaborators: { logos: [] }
        };

        let githubToken = '';
        let confirmCallback = null;
        let inactivityTimer = null;
        const INACTIVITY_TIMEOUT = 30 * 60 * 1000; // 30分钟

        // 文件映射配置
        const fileMapping = {
            'banners': { file: 'banners.json', key: 'banners' },
            'posters': { 
                files: [
                    { file: 'index-posters.json', key: 'indexPosters' },
                    { file: 'cn-posters.json', key: 'cnPosters' },
                    { file: 'events-posters.json', key: 'eventsPosters' }
                ]
            },
            'events': { file: 'events-managed.json', key: 'eventsManaged' },
            'carousel': { file: 'events-carousel.json', key: 'eventsCarousel' },
            'footer': {
                files: [
                    { file: 'footer-global.json', key: 'footerGlobal' },
                    { file: 'footer-cn.json', key: 'footerCN' }
                ]
            },
            'partners': {
                files: [
                    { file: 'partners-banners.json', key: 'partnersBanners' },
                    { file: 'collaborators.json', key: 'collaborators' }
                ]
            }
        };

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 检查登录状态
            if (localStorage.getItem('livegigs_admin_logged_in')) {
                const savedTime = parseInt(localStorage.getItem('livegigs_admin_login_time') || '0');
                const now = Date.now();

                if (now - savedTime < INACTIVITY_TIMEOUT) {
                    githubToken = localStorage.getItem('livegigs_github_token') || '';
                    showAdminPanel();
                    loadAllData();
                } else {
                    logout();
                }
            }

            // 登录表单
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                githubToken = document.getElementById('githubToken').value;

                if (username === 'admin' && password === '00123456a') {
                    localStorage.setItem('livegigs_admin_logged_in', 'true');
                    localStorage.setItem('livegigs_admin_login_time', Date.now().toString());
                    localStorage.setItem('livegigs_github_token', githubToken);
                    showAdminPanel();
                    loadAllData();
                    startInactivityTimer();
                } else {
                    alert('用戶名或密碼錯誤');
                }
            });

            // 监听活动重置计时器
            document.addEventListener('click', resetInactivityTimer);
            document.addEventListener('keypress', resetInactivityTimer);
        });

        // 显示后台面板
        function showAdminPanel() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
        }

        // 非活动计时器
        function startInactivityTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                alert('由於長時間未操作，系統已自動退出');
                logout();
            }, INACTIVITY_TIMEOUT);
        }

        function resetInactivityTimer() {
            startInactivityTimer();
        }

        // 退出登录
        function logout() {
            localStorage.removeItem('livegigs_admin_logged_in');
            localStorage.removeItem('livegigs_admin_login_time');
            localStorage.removeItem('livegigs_github_token');
            location.reload();
        }

        // 显示提示
        function showAlert(message, type) {
            const alertBox = document.getElementById('alertBox');
            alertBox.textContent = message;
            alertBox.className = `alert alert-${type} show`;
            setTimeout(() => {
                alertBox.classList.remove('show');
            }, 5000);
        }

        // 切换页面区域
        function showSection(section) {
            // 更新导航
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === section) {
                    item.classList.add('active');
                }
            });

            // 更新内容
            document.querySelectorAll('.section').forEach(sec => {
                sec.classList.remove('active');
            });
            const targetSection = document.getElementById(section);
            if (targetSection) {
                targetSection.classList.add('active');
                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // 刷新数据
            if (section !== 'dashboard') {
                renderSection(section);
            } else {
                updateDashboard();
            }

            return false;
        }

        // 加载所有数据
        async function loadAllData() {
            try {
                const files = [
                    'banners', 'index-posters', 'cn-posters', 'events-posters',
                    'events-managed', 'events-carousel', 'footer-global', 'footer-cn',
                    'partners-banners', 'collaborators'
                ];

                for (const file of files) {
                    try {
                        const response = await fetch(`../content/${file}.json?v=${Date.now()}`);
                        if (response.ok) {
                            const data = await response.json();
                            const key = file.replace(/-([a-z])/g, (g) => g[1].toUpperCase());
                            appData[key] = data;
                        }
                    } catch (e) {
                        console.log(`Failed to load ${file}:`, e);
                    }
                }

                initializeDataStructure();
                updateDashboard();
                renderAllSections();
                showAlert('數據加載完成', 'success');
            } catch (error) {
                showAlert('數據加載失敗: ' + error.message, 'error');
            }
        }

        // 初始化数据结构
        function initializeDataStructure() {
            // Banner: 5个位置
            if (!appData.banners.banners || appData.banners.banners.length === 0) {
                appData.banners.banners = Array(5).fill(null).map((_, i) => ({
                    id: i + 1, title: '', buttonText: '', link: '', image: '', order: i + 1, enabled: false
                }));
            }

            // Index海报: 3个
            if (!appData.indexPosters.posters || appData.indexPosters.posters.length === 0) {
                appData.indexPosters.posters = Array(3).fill(null).map((_, i) => ({
                    id: i + 1, title: '', linkText: '', link: '', image: '', enabled: false
                }));
            }

            // CN海报: 3个
            if (!appData.cnPosters.posters || appData.cnPosters.posters.length === 0) {
                appData.cnPosters.posters = Array(3).fill(null).map((_, i) => ({
                    id: i + 1, title: '', linkText: '', link: '', image: '', enabled: false
                }));
            }

            // Events海报: 5个
            if (!appData.eventsPosters.posters || appData.eventsPosters.posters.length === 0) {
                appData.eventsPosters.posters = Array(5).fill(null).map((_, i) => ({
                    id: i + 1, title: '', linkText: '', link: '', image: '', enabled: false
                }));
            }

            // 自主活动: 9个
            if (!appData.eventsManaged.events || appData.eventsManaged.events.length === 0) {
                appData.eventsManaged.events = Array(9).fill(null).map((_, i) => ({
                    id: i + 1, title: '', date: '', venue: '', time: '', image: '',
                    ticket: '', status: '', buttonText: '', link: '', enabled: false
                }));
            }

            // 滚播活动: 12个
            if (!appData.eventsCarousel.carousel || appData.eventsCarousel.carousel.length === 0) {
                appData.eventsCarousel.carousel = Array(12).fill(null).map((_, i) => ({
                    id: i + 1, title: '', buttonText: '', link: '', image: '', date: '', order: i + 1, enabled: false
                }));
            }

            // Partners Banner: 9个
            if (!appData.partnersBanners.banners || appData.partnersBanners.banners.length === 0) {
                appData.partnersBanners.banners = Array(9).fill(null).map((_, i) => ({
                    id: i + 1, mainImage: '', logoImage: '', title: '', description: '',
                    buttonText: '', link: '', enabled: false
                }));
            }

            // 合作Logo: 9个
            if (!appData.collaborators.logos || appData.collaborators.logos.length === 0) {
                appData.collaborators.logos = Array(9).fill(null).map((_, i) => ({
                    id: i + 1, name: '', image: '', link: '', enabled: false
                }));
            }

            // 社交媒体: 10个
            if (!appData.footerGlobal.socials || appData.footerGlobal.socials.length === 0) {
                appData.footerGlobal.socials = Array(10).fill(null).map((_, i) => ({
                    id: i + 1, name: '', icon: '', link: '', enabled: false
                }));
            }
            if (!appData.footerCN.socials || appData.footerCN.socials.length === 0) {
                appData.footerCN.socials = Array(10).fill(null).map((_, i) => ({
                    id: i + 1, name: '', icon: '', link: '', enabled: false
                }));
            }
        }

        // 渲染所有区域
        function renderAllSections() {
            renderSection('banners');
            renderSection('posters');
            renderSection('events');
            renderSection('carousel');
            renderSection('footer');
            renderSection('partners');
        }

        // 更新Dashboard统计
        function updateDashboard() {
            const bannerEnabled = appData.banners.banners.filter(b => b.enabled).length;
            const posterEnabled = appData.indexPosters.posters.filter(p => p.enabled).length;
            const eventEnabled = appData.eventsManaged.events.filter(e => e.enabled).length;
            const carouselEnabled = appData.eventsCarousel.carousel.filter(c => c.enabled).length;
            const partnerBannerEnabled = appData.partnersBanners.banners.filter(b => b.enabled).length;
            const logoEnabled = appData.collaborators.logos.filter(l => l.enabled).length;

            document.getElementById('statBanners').textContent = bannerEnabled;
            document.getElementById('statPosters').textContent = posterEnabled;
            document.getElementById('statEvents').textContent = eventEnabled;
            document.getElementById('statCarousel').textContent = carouselEnabled;
            document.getElementById('statPartners').textContent = partnerBannerEnabled;
            document.getElementById('statLogos').textContent = logoEnabled;

            document.getElementById('bannerCount').textContent = bannerEnabled;
            document.getElementById('posterCount').textContent = posterEnabled;
            document.getElementById('eventCount').textContent = eventEnabled;
            document.getElementById('carouselCount').textContent = carouselEnabled;
            document.getElementById('partnerCount').textContent = partnerBannerEnabled + logoEnabled;
        }

        // 渲染区域
        function renderSection(section) {
            switch(section) {
                case 'banners':
                    renderBanners();
                    break;
                case 'posters':
                    renderPosters();
                    break;
                case 'events':
                    renderEvents();
                    break;
                case 'carousel':
                    renderCarousel();
                    break;
                case 'footer':
                    renderFooter();
                    break;
                case 'partners':
                    renderPartners();
                    break;
            }
        }

        // 渲染Banner表格
        function renderBanners() {
            const tbody = document.getElementById('bannerTableBody');
            if (!tbody) return;

            const enabled = appData.banners.banners.filter(b => b.enabled).length;
            document.getElementById('enabledBanners').textContent = enabled;

            tbody.innerHTML = appData.banners.banners.map((banner, index) => `
                <tr class="${banner.enabled ? '' : 'disabled'}" data-id="${banner.id}">
                    <td><input type="checkbox" ${banner.enabled ? 'checked' : ''} onchange="updateBanner(${index}, 'enabled', this.checked)"></td>
                    <td><input type="number" class="order-input" value="${banner.order || index + 1}" onchange="updateBanner(${index}, 'order', this.value)"></td>
                    <td><input type="text" value="${banner.title || ''}" onchange="updateBanner(${index}, 'title', this.value)" placeholder="留空不顯示"></td>
                    <td><input type="text" value="${banner.buttonText || ''}" onchange="updateBanner(${index}, 'buttonText', this.value)" placeholder="留空不顯示"></td>
                    <td><input type="text" value="${banner.link || ''}" onchange="updateBanner(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                    <td><input type="text" value="${banner.image || ''}" onchange="updateBanner(${index}, 'image', this.value)" placeholder="./image/... 或網址"></td>
                    <td>${banner.image ? `<img src="${banner.image}" class="img-preview" onerror="this.style.display='none'">` : '-'}</td>
                </tr>
            `).join('');
        }

        function updateBanner(index, field, value) {
            if (field === 'order') value = parseInt(value) || 0;
            if (field === 'enabled') value = Boolean(value);
            appData.banners.banners[index][field] = value;
            renderBanners();
            updateDashboard();
        }

        function addBannerRow() {
            const enabled = appData.banners.banners.filter(b => b.enabled).length;
            if (enabled >= 5) {
                showAlert('最多只能啟用5個Banner', 'error');
                return;
            }
            const disabled = appData.banners.banners.find(b => !b.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderBanners();
                updateDashboard();
            }
        }

        // 渲染海报
        function renderPosters() {
            // Index海报
            const indexTbody = document.getElementById('indexPosterTableBody');
            if (indexTbody) {
                indexTbody.innerHTML = appData.indexPosters.posters.map((poster, index) => `
                    <tr class="${poster.enabled ? '' : 'disabled'}" data-id="${poster.id}">
                        <td><input type="checkbox" ${poster.enabled ? 'checked' : ''} onchange="updateIndexPoster(${index}, 'enabled', this.checked)"></td>
                        <td><input type="text" value="${poster.title || ''}" onchange="updateIndexPoster(${index}, 'title', this.value)" placeholder="留空不顯示"></td>
                        <td><input type="text" value="${poster.linkText || ''}" onchange="updateIndexPoster(${index}, 'linkText', this.value)" placeholder="留空不顯示"></td>
                        <td><input type="text" value="${poster.link || ''}" onchange="updateIndexPoster(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                        <td><input type="text" value="${poster.image || ''}" onchange="updateIndexPoster(${index}, 'image', this.value)" placeholder="圖片地址"></td>
                        <td>${poster.image ? `<img src="${poster.image}" class="img-preview" onerror="this.style.display='none'">` : '-'}</td>
                    </tr>
                `).join('');
            }

            // CN海报
            const cnTbody = document.getElementById('cnPosterTableBody');
            if (cnTbody) {
                cnTbody.innerHTML = appData.cnPosters.posters.map((poster, index) => `
                    <tr class="${poster.enabled ? '' : 'disabled'}" data-id="${poster.id}">
                        <td><input type="checkbox" ${poster.enabled ? 'checked' : ''} onchange="updateCnPoster(${index}, 'enabled', this.checked)"></td>
                        <td><input type="text" value="${poster.title || ''}" onchange="updateCnPoster(${index}, 'title', this.value)" placeholder="留空不顯示"></td>
                        <td><input type="text" value="${poster.linkText || ''}" onchange="updateCnPoster(${index}, 'linkText', this.value)" placeholder="留空不顯示"></td>
                        <td><input type="text" value="${poster.link || ''}" onchange="updateCnPoster(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                        <td><input type="text" value="${poster.image || ''}" onchange="updateCnPoster(${index}, 'image', this.value)" placeholder="圖片地址"></td>
                        <td>${poster.image ? `<img src="${poster.image}" class="img-preview" onerror="this.style.display='none'">` : '-'}</td>
                    </tr>
                `).join('');
            }

            // Events海报2
            const poster2Carousel = document.getElementById('poster2Carousel');
            if (poster2Carousel) {
                poster2Carousel.checked = appData.eventsPosters.poster2_carousel || false;
            }

            const eventsTbody = document.getElementById('eventsPosterTableBody');
            if (eventsTbody) {
                eventsTbody.innerHTML = appData.eventsPosters.posters.map((poster, index) => `
                    <tr class="${poster.enabled ? '' : 'disabled'}" data-id="${poster.id}">
                        <td><input type="checkbox" ${poster.enabled ? 'checked' : ''} onchange="updateEventsPoster(${index}, 'enabled', this.checked)"></td>
                        <td><input type="text" value="${poster.title || ''}" onchange="updateEventsPoster(${index}, 'title', this.value)" placeholder="留空不顯示"></td>
                        <td><input type="text" value="${poster.linkText || ''}" onchange="updateEventsPoster(${index}, 'linkText', this.value)" placeholder="留空不顯示"></td>
                        <td><input type="text" value="${poster.link || ''}" onchange="updateEventsPoster(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                        <td><input type="text" value="${poster.image || ''}" onchange="updateEventsPoster(${index}, 'image', this.value)" placeholder="圖片地址"></td>
                        <td>${poster.image ? `<img src="${poster.image}" class="img-preview" onerror="this.style.display='none'">` : '-'}</td>
                    </tr>
                `).join('');
            }
        }

        function updateIndexPoster(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.indexPosters.posters[index][field] = value;
            updateDashboard();
        }

        function updateCnPoster(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.cnPosters.posters[index][field] = value;
            updateDashboard();
        }

        function updateEventsPoster(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.eventsPosters.posters[index][field] = value;
            updateDashboard();
        }

        function togglePoster2Carousel() {
            const checkbox = document.getElementById('poster2Carousel');
            if (checkbox) {
                appData.eventsPosters.poster2_carousel = checkbox.checked;
            }
        }

        function addEventsPosterRow() {
            const enabled = appData.eventsPosters.posters.filter(p => p.enabled).length;
            if (enabled >= 5) {
                showAlert('最多只能啟用5個海報', 'error');
                return;
            }
            const disabled = appData.eventsPosters.posters.find(p => !p.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderPosters();
                updateDashboard();
            }
        }

        function switchPosterTab(tab) {
            document.querySelectorAll('#posters .tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll('#posters .tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`poster-${tab}`).classList.add('active');
        }

        // 渲染自主活动
        function renderEvents() {
            const tbody = document.getElementById('eventsTableBody');
            if (!tbody) return;

            const enabled = appData.eventsManaged.events.filter(e => e.enabled).length;
            document.getElementById('enabledEvents').textContent = enabled;
            document.getElementById('loadMoreStatus').textContent = enabled > 3 ? '顯示' : '隱藏';

            tbody.innerHTML = appData.eventsManaged.events.map((event, index) => `
                <tr class="${event.enabled ? '' : 'disabled'}" data-id="${event.id}">
                    <td><input type="checkbox" ${event.enabled ? 'checked' : ''} onchange="updateEvent(${index}, 'enabled', this.checked)"></td>
                    <td><input type="text" value="${event.title || ''}" onchange="updateEvent(${index}, 'title', this.value)" placeholder="留空不顯示"></td>
                    <td><input type="text" value="${event.date || ''}" onchange="updateEvent(${index}, 'date', this.value)" placeholder="2026.01.01"></td>
                    <td><input type="text" value="${event.venue || ''}" onchange="updateEvent(${index}, 'venue', this.value)" placeholder="地點"></td>
                    <td><input type="text" value="${event.time || ''}" onchange="updateEvent(${index}, 'time', this.value)" placeholder="20:00"></td>
                    <td><input type="text" value="${event.ticket || ''}" onchange="updateEvent(${index}, 'ticket', this.value)" placeholder="$100"></td>
                    <td>
                        <select onchange="updateEvent(${index}, 'status', this.value)" style="background: #ffffff; border: 1px solid #8b0000; color: #1a1a1a; padding: 5px; font-family: Arial, sans-serif;">
                            <option value="" ${!event.status ? 'selected' : ''}>倒數計時</option>
                            <option value="SOLD OUT" ${event.status === 'SOLD OUT' ? 'selected' : ''}>SOLD OUT</option>
                            <option value="ON TOUR" ${event.status === 'ON TOUR' ? 'selected' : ''}>ON TOUR</option>
                        </select>
                    </td>
                    <td><input type="text" value="${event.buttonText || ''}" onchange="updateEvent(${index}, 'buttonText', this.value)" placeholder="留空不顯示"></td>
                    <td><input type="text" value="${event.link || ''}" onchange="updateEvent(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                    <td><input type="text" value="${event.image || ''}" onchange="updateEvent(${index}, 'image', this.value)" placeholder="圖片地址"></td>
                </tr>
            `).join('');
        }

        function updateEvent(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.eventsManaged.events[index][field] = value;
            renderEvents();
            updateDashboard();
        }

        function addEventRow() {
            const enabled = appData.eventsManaged.events.filter(e => e.enabled).length;
            if (enabled >= 9) {
                showAlert('最多只能啟用9個活動', 'error');
                return;
            }
            const disabled = appData.eventsManaged.events.find(e => !e.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderEvents();
                updateDashboard();
            }
        }

        // 渲染滚播活动
        function renderCarousel() {
            const tbody = document.getElementById('carouselTableBody');
            if (!tbody) return;

            const enabled = appData.eventsCarousel.carousel.filter(c => c.enabled).length;
            document.getElementById('enabledCarousel').textContent = enabled;

            tbody.innerHTML = appData.eventsCarousel.carousel.map((item, index) => `
                <tr class="${item.enabled ? '' : 'disabled'}" data-id="${item.id}">
                    <td><input type="checkbox" ${item.enabled ? 'checked' : ''} onchange="updateCarousel(${index}, 'enabled', this.checked)"></td>
                    <td><input type="number" class="order-input" value="${item.order || index + 1}" onchange="updateCarousel(${index}, 'order', this.value)"></td>
                    <td><input type="text" value="${item.title || ''}" onchange="updateCarousel(${index}, 'title', this.value)" placeholder="留空不顯示"></td>
                    <td><input type="text" value="${item.buttonText || ''}" onchange="updateCarousel(${index}, 'buttonText', this.value)" placeholder="留空不顯示"></td>
                    <td><input type="text" value="${item.link || ''}" onchange="updateCarousel(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                    <td><input type="text" value="${item.date || ''}" onchange="updateCarousel(${index}, 'date', this.value)" placeholder="2026.01.01"></td>
                    <td><input type="text" value="${item.image || ''}" onchange="updateCarousel(${index}, 'image', this.value)" placeholder="圖片地址"></td>
                    <td>${item.image ? `<img src="${item.image}" class="img-preview" onerror="this.style.display='none'">` : '-'}</td>
                </tr>
            `).join('');
        }

        function updateCarousel(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            if (field === 'order') value = parseInt(value) || 0;
            appData.eventsCarousel.carousel[index][field] = value;
            renderCarousel();
            updateDashboard();
        }

        function addCarouselRow() {
            const enabled = appData.eventsCarousel.carousel.filter(c => c.enabled).length;
            if (enabled >= 12) {
                showAlert('最多只能啟用12個滾播', 'error');
                return;
            }
            const disabled = appData.eventsCarousel.carousel.find(c => !c.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderCarousel();
                updateDashboard();
            }
        }

        // 渲染底部
        function renderFooter() {
            // 海外站
            if (appData.footerGlobal) {
                const globalSiteName = document.getElementById('globalSiteName');
                const globalSiteAsia = document.getElementById('globalSiteAsia');
                const globalContactText = document.getElementById('globalContactText');
                const globalEmail = document.getElementById('globalEmail');
                const globalAddress = document.getElementById('globalAddress');
                const globalCopyright = document.getElementById('globalCopyright');
                const globalProducerLogo = document.getElementById('globalProducerLogo');

                if (globalSiteName) globalSiteName.value = appData.footerGlobal.siteName || 'LIVEGIGS';
                if (globalSiteAsia) globalSiteAsia.value = appData.footerGlobal.siteNameAsia || 'ASIA';
                if (globalContactText) globalContactText.value = appData.footerGlobal.contactText || 'For inquiries and partnership opportunities, reach out to us at:';
                if (globalEmail) globalEmail.value = appData.footerGlobal.email || 'xrebooking@hotmail.com';
                if (globalAddress) globalAddress.value = appData.footerGlobal.address || 'Hong Kong | Shanghai | Beijing';
                if (globalCopyright) globalCopyright.value = appData.footerGlobal.copyright || 'Copyright © 2001-2026 EMANON ENT';
                if (globalProducerLogo) globalProducerLogo.value = appData.footerGlobal.producerLogo || './image/emanonent-logo.png';

                const globalSocialTbody = document.getElementById('globalSocialTableBody');
                if (globalSocialTbody) {
                    globalSocialTbody.innerHTML = appData.footerGlobal.socials.map((social, index) => `
                        <tr class="${social.enabled ? '' : 'disabled'}">
                            <td><input type="checkbox" ${social.enabled ? 'checked' : ''} onchange="updateGlobalSocial(${index}, 'enabled', this.checked)"></td>
                            <td><input type="text" value="${social.name || ''}" onchange="updateGlobalSocial(${index}, 'name', this.value)" placeholder="名稱"></td>
                            <td>
                                <select onchange="updateGlobalSocial(${index}, 'icon', this.value)" style="background: #ffffff; border: 1px solid #8b0000; color: #1a1a1a; padding: 5px; font-family: Arial, sans-serif;">
                                    <option value="">選擇圖標</option>
                                    <option value="facebook" ${social.icon === 'facebook' ? 'selected' : ''}>Facebook</option>
                                    <option value="instagram" ${social.icon === 'instagram' ? 'selected' : ''}>Instagram</option>
                                    <option value="youtube" ${social.icon === 'youtube' ? 'selected' : ''}>YouTube</option>
                                    <option value="x" ${social.icon === 'x' ? 'selected' : ''}>X (Twitter)</option>
                                </select>
                            </td>
                            <td><input type="text" value="${social.link || ''}" onchange="updateGlobalSocial(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                        </tr>
                    `).join('');
                }
            }

            // 国内站
            if (appData.footerCN) {
                const cnSiteName = document.getElementById('cnSiteName');
                const cnSiteAsia = document.getElementById('cnSiteAsia');
                const cnContactText = document.getElementById('cnContactText');
                const cnEmail = document.getElementById('cnEmail');
                const cnAddress = document.getElementById('cnAddress');
                const cnCopyright = document.getElementById('cnCopyright');
                const cnProducerLogo = document.getElementById('cnProducerLogo');

                if (cnSiteName) cnSiteName.value = appData.footerCN.siteName || 'LIVEGIGS';
                if (cnSiteAsia) cnSiteAsia.value = appData.footerCN.siteNameAsia || 'CN';
                if (cnContactText) cnContactText.value = appData.footerCN.contactText || '如需咨询和合作机会，请联系我们：';
                if (cnEmail) cnEmail.value = appData.footerCN.email || 'xrebooking@hotmail.com';
                if (cnAddress) cnAddress.value = appData.footerCN.address || '香港 | 上海 | 北京';
                if (cnCopyright) cnCopyright.value = appData.footerCN.copyright || 'Copyright © 2001-2026 EMANON ENT';
                if (cnProducerLogo) cnProducerLogo.value = appData.footerCN.producerLogo || './image/emanonent-logo.png';

                const cnSocialTbody = document.getElementById('cnSocialTableBody');
                if (cnSocialTbody) {
                    cnSocialTbody.innerHTML = appData.footerCN.socials.map((social, index) => `
                        <tr class="${social.enabled ? '' : 'disabled'}">
                            <td><input type="checkbox" ${social.enabled ? 'checked' : ''} onchange="updateCnSocial(${index}, 'enabled', this.checked)"></td>
                            <td><input type="text" value="${social.name || ''}" onchange="updateCnSocial(${index}, 'name', this.value)" placeholder="名稱"></td>
                            <td>
                                <select onchange="updateCnSocial(${index}, 'icon', this.value)" style="background: #ffffff; border: 1px solid #8b0000; color: #1a1a1a; padding: 5px; font-family: Arial, sans-serif;">
                                    <option value="">選擇圖標</option>
                                    <option value="wechat" ${social.icon === 'wechat' ? 'selected' : ''}>微信</option>
                                    <option value="weibo" ${social.icon === 'weibo' ? 'selected' : ''}>微博</option>
                                    <option value="xiaohongshu" ${social.icon === 'xiaohongshu' ? 'selected' : ''}>小紅書</option>
                                    <option value="miniprogram" ${social.icon === 'miniprogram' ? 'selected' : ''}>小程序</option>
                                </select>
                            </td>
                            <td><input type="text" value="${social.link || ''}" onchange="updateCnSocial(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                        </tr>
                    `).join('');
                }
            }
        }

        function updateGlobalSocial(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.footerGlobal.socials[index][field] = value;
        }

        function updateCnSocial(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.footerCN.socials[index][field] = value;
        }

        function switchFooterTab(tab) {
            document.querySelectorAll('#footer .tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll('#footer .tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`footer-${tab}`).classList.add('active');
        }

        function addGlobalSocialRow() {
            const enabled = appData.footerGlobal.socials.filter(s => s.enabled).length;
            if (enabled >= 10) {
                showAlert('最多只能啟用10個社交媒體', 'error');
                return;
            }
            const disabled = appData.footerGlobal.socials.find(s => !s.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderFooter();
            }
        }

        function addCnSocialRow() {
            const enabled = appData.footerCN.socials.filter(s => s.enabled).length;
            if (enabled >= 10) {
                showAlert('最多只能啟用10個社交媒體', 'error');
                return;
            }
            const disabled = appData.footerCN.socials.find(s => !s.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderFooter();
            }
        }

        // 渲染合作伙伴
        function renderPartners() {
            // Banner
            const bannerTbody = document.getElementById('partnerBannerTableBody');
            if (bannerTbody) {
                const enabledBanners = appData.partnersBanners.banners.filter(b => b.enabled).length;
                document.getElementById('enabledPartnerBanners').textContent = enabledBanners;

                bannerTbody.innerHTML = appData.partnersBanners.banners.map((banner, index) => `
                    <tr class="${banner.enabled ? '' : 'disabled'}" data-id="${banner.id}">
                        <td><input type="checkbox" ${banner.enabled ? 'checked' : ''} onchange="updatePartnerBanner(${index}, 'enabled', this.checked)"></td>
                        <td><input type="text" value="${banner.mainImage || ''}" onchange="updatePartnerBanner(${index}, 'mainImage', this.value)" placeholder="主海報"></td>
                        <td><input type="text" value="${banner.logoImage || ''}" onchange="updatePartnerBanner(${index}, 'logoImage', this.value)" placeholder="Logo圖"></td>
                        <td><input type="text" value="${banner.title || ''}" onchange="updatePartnerBanner(${index}, 'title', this.value)" placeholder="留空不顯示"></td>
                        <td><textarea onchange="updatePartnerBanner(${index}, 'description', this.value)" placeholder="留空不顯示">${banner.description || ''}</textarea></td>
                        <td><input type="text" value="${banner.buttonText || ''}" onchange="updatePartnerBanner(${index}, 'buttonText', this.value)" placeholder="留空不顯示"></td>
                        <td><input type="text" value="${banner.link || ''}" onchange="updatePartnerBanner(${index}, 'link', this.value)" placeholder="留空不點擊"></td>
                    </tr>
                `).join('');
            }

            // Logos
            const logoTbody = document.getElementById('partnerLogoTableBody');
            if (logoTbody) {
                const enabledLogos = appData.collaborators.logos.filter(l => l.enabled).length;
                document.getElementById('enabledPartnerLogos').textContent = enabledLogos;

                logoTbody.innerHTML = appData.collaborators.logos.map((logo, index) => `
                    <tr class="${logo.enabled ? '' : 'disabled'}" data-id="${logo.id}">
                        <td><input type="checkbox" ${logo.enabled ? 'checked' : ''} onchange="updatePartnerLogo(${index}, 'enabled', this.checked)"></td>
                        <td><input type="text" value="${logo.name || ''}" onchange="updatePartnerLogo(${index}, 'name', this.value)" placeholder="名稱"></td>
                        <td><input type="text" value="${logo.image || ''}" onchange="updatePartnerLogo(${index}, 'image', this.value)" placeholder="Logo圖片"></td>
                        <td><input type="text" value="${logo.link || ''}" onchange="updatePartnerLogo(${index}, 'link', this.value)" placeholder="留空則不可點擊"></td>
                    </tr>
                `).join('');
            }
        }

        function updatePartnerBanner(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.partnersBanners.banners[index][field] = value;
            renderPartners();
            updateDashboard();
        }

        function updatePartnerLogo(index, field, value) {
            if (field === 'enabled') value = Boolean(value);
            appData.collaborators.logos[index][field] = value;
            renderPartners();
            updateDashboard();
        }

        function addPartnerBannerRow() {
            const enabled = appData.partnersBanners.banners.filter(b => b.enabled).length;
            if (enabled >= 9) {
                showAlert('最多只能啟用9個Banner', 'error');
                return;
            }
            const disabled = appData.partnersBanners.banners.find(b => !b.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderPartners();
                updateDashboard();
            }
        }

        function addPartnerLogoRow() {
            const enabled = appData.collaborators.logos.filter(l => l.enabled).length;
            if (enabled >= 9) {
                showAlert('最多只能啟用9個Logo', 'error');
                return;
            }
            const disabled = appData.collaborators.logos.find(l => !l.enabled);
            if (disabled) {
                disabled.enabled = true;
                renderPartners();
                updateDashboard();
            }
        }

        function switchPartnerTab(tab) {
            document.querySelectorAll('#partners .tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll('#partners .tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`partner-${tab}`).classList.add('active');
        }

        // 同步单个区域到GitHub
        async function syncSection(section) {
            if (!githubToken) {
                showAlert('請先設置GitHub Token', 'error');
                return;
            }

            const mapping = fileMapping[section];
            if (!mapping) {
                showAlert('未知的區域: ' + section, 'error');
                return;
            }

            showAlert('正在同步 ' + section + '...', 'warning');

            try {
                let files = [];
                if (mapping.files) {
                    // 多个文件
                    files = mapping.files.map(f => ({
                        name: f.file,
                        content: JSON.stringify(appData[f.key], null, 2)
                    }));
                } else {
                    // 单个文件
                    files = [{
                        name: mapping.file,
                        content: JSON.stringify(appData[mapping.key], null, 2)
                    }];
                }

                let successCount = 0;
                let failCount = 0;

                for (const file of files) {
                    try {
                        // 获取当前文件的SHA（如果存在）
                        let sha = null;
                        try {
                            const getResponse = await fetch(`https://api.github.com/repos/EmanonEnt/asia/contents/content/${file.name}`, {
                                headers: { 'Authorization': `token ${githubToken}` }
                            });
                            if (getResponse.ok) {
                                const data = await getResponse.json();
                                sha = data.sha;
                            }
                        } catch (e) {
                            // 文件可能不存在
                        }

                        // 更新或创建文件
                        const body = {
                            message: `Update ${file.name} via admin (${section})`,
                            content: btoa(unescape(encodeURIComponent(file.content)))
                        };
                        if (sha) body.sha = sha;

                        const response = await fetch(`https://api.github.com/repos/EmanonEnt/asia/contents/content/${file.name}`, {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${githubToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(body)
                        });

                        if (response.ok) {
                            successCount++;
                        } else {
                            failCount++;
                            console.error(`Failed to update ${file.name}:`, await response.text());
                        }
                    } catch (e) {
                        failCount++;
                        console.error(`Error updating ${file.name}:`, e);
                    }
                }

                if (failCount === 0) {
                    showAlert(`${section} 區域同步成功 (${successCount} 個文件)`, 'success');
                    updateSyncStatus('success');
                } else {
                    showAlert(`${section} 區域同步完成: ${successCount} 成功, ${failCount} 失敗`, 'error');
                    updateSyncStatus('error');
                }
            } catch (error) {
                showAlert('同步失敗: ' + error.message, 'error');
                updateSyncStatus('error');
            }
        }

        // 全站同步
        async function syncAllToGitHub() {
            if (!githubToken) {
                showAlert('請先設置GitHub Token', 'error');
                return;
            }

            const statusEl = document.getElementById('syncStatus');
            statusEl.textContent = '同步中...';
            statusEl.className = 'sync-status pending';

            try {
                // 准备所有JSON文件
                const files = [
                    { name: 'banners.json', content: JSON.stringify(appData.banners, null, 2) },
                    { name: 'index-posters.json', content: JSON.stringify(appData.indexPosters, null, 2) },
                    { name: 'cn-posters.json', content: JSON.stringify(appData.cnPosters, null, 2) },
                    { name: 'events-posters.json', content: JSON.stringify(appData.eventsPosters, null, 2) },
                    { name: 'events-managed.json', content: JSON.stringify(appData.eventsManaged, null, 2) },
                    { name: 'events-carousel.json', content: JSON.stringify(appData.eventsCarousel, null, 2) },
                    { name: 'footer-global.json', content: JSON.stringify(getFooterGlobalData(), null, 2) },
                    { name: 'footer-cn.json', content: JSON.stringify(getFooterCNData(), null, 2) },
                    { name: 'partners-banners.json', content: JSON.stringify(appData.partnersBanners, null, 2) },
                    { name: 'collaborators.json', content: JSON.stringify(appData.collaborators, null, 2) }
                ];

                let successCount = 0;
                let failCount = 0;

                for (const file of files) {
                    try {
                        // 获取当前文件的SHA（如果存在）
                        let sha = null;
                        try {
                            const getResponse = await fetch(`https://api.github.com/repos/EmanonEnt/asia/contents/content/${file.name}`, {
                                headers: { 'Authorization': `token ${githubToken}` }
                            });
                            if (getResponse.ok) {
                                const data = await getResponse.json();
                                sha = data.sha;
                            }
                        } catch (e) {
                            // 文件可能不存在
                        }

                        // 更新或创建文件
                        const body = {
                            message: `Update ${file.name} via admin (full sync)`,
                            content: btoa(unescape(encodeURIComponent(file.content)))
                        };
                        if (sha) body.sha = sha;

                        const response = await fetch(`https://api.github.com/repos/EmanonEnt/asia/contents/content/${file.name}`, {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${githubToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(body)
                        });

                        if (response.ok) {
                            successCount++;
                        } else {
                            failCount++;
                            console.error(`Failed to update ${file.name}:`, await response.text());
                        }
                    } catch (e) {
                        failCount++;
                        console.error(`Error updating ${file.name}:`, e);
                    }
                }

                if (failCount === 0) {
                    statusEl.textContent = '同步成功';
                    statusEl.className = 'sync-status success';
                    document.getElementById('lastSync').textContent = new Date().toLocaleString();
                    showAlert(`全站同步成功: ${successCount} 個文件`, 'success');
                } else {
                    statusEl.textContent = '同步失敗';
                    statusEl.className = 'sync-status error';
                    showAlert(`同步完成: ${successCount} 成功, ${failCount} 失敗`, 'error');
                }
            } catch (error) {
                statusEl.textContent = '同步錯誤';
                statusEl.className = 'sync-status error';
                showAlert('同步失敗: ' + error.message, 'error');
            }
        }

        // 获取底部数据（从表单读取）
        function getFooterGlobalData() {
            const socials = appData.footerGlobal.socials || [];
            return {
                siteName: document.getElementById('globalSiteName')?.value || 'LIVEGIGS',
                siteNameAsia: document.getElementById('globalSiteAsia')?.value || 'ASIA',
                contactText: document.getElementById('globalContactText')?.value || '',
                email: document.getElementById('globalEmail')?.value || '',
                address: document.getElementById('globalAddress')?.value || '',
                copyright: document.getElementById('globalCopyright')?.value || '',
                producerLogo: document.getElementById('globalProducerLogo')?.value || './image/emanonent-logo.png',
                socials: socials
            };
        }

        function getFooterCNData() {
            const socials = appData.footerCN.socials || [];
            return {
                siteName: document.getElementById('cnSiteName')?.value || 'LIVEGIGS',
                siteNameAsia: document.getElementById('cnSiteAsia')?.value || 'CN',
                contactText: document.getElementById('cnContactText')?.value || '',
                email: document.getElementById('cnEmail')?.value || '',
                address: document.getElementById('cnAddress')?.value || '',
                copyright: document.getElementById('cnCopyright')?.value || '',
                producerLogo: document.getElementById('cnProducerLogo')?.value || './image/emanonent-logo.png',
                socials: socials
            };
        }

        // 更新同步状态
        function updateSyncStatus(status) {
            const statusEl = document.getElementById('syncStatus');
            if (status === 'success') {
                statusEl.textContent = '已同步';
                statusEl.className = 'sync-status success';
                document.getElementById('lastSync').textContent = new Date().toLocaleString();
            } else if (status === 'error') {
                statusEl.textContent = '同步失敗';
                statusEl.className = 'sync-status error';
            }
        }

        // 下载所有数据
        function downloadAllData() {
            // 先更新底部数据
            appData.footerGlobal = getFooterGlobalData();
            appData.footerCN = getFooterCNData();

            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `livegigs-backup-${new Date().toISOString().slice(0, 10)}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showAlert('數據已下載', 'success');
        }

        // 模态框
        function showModal(message, callback) {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmModal').classList.add('show');
            confirmCallback = callback;
        }

        function closeModal() {
            document.getElementById('confirmModal').classList.remove('show');
            confirmCallback = null;
        }

        function confirmAction() {
            if (confirmCallback) {
                confirmCallback();
            }
            closeModal();
        }

        // 页面关闭检查
        window.addEventListener('beforeunload', function(e) {
            // 可以添加未保存更改的提示
        });
    </script>
</body>
</html>
